{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lahiru deshan\\\\Desktop\\\\CropWise_GitHub\\\\EcoCollect\\\\apps\\\\frontend\\\\src\\\\pages\\\\RouteOptimizationPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Map, { defaultWasteCollectionPoints, dummyCollectionBins } from '../components/Map';\nimport { routeAPI } from '../services/api';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function RouteOptimizationPage() {\n  _s();\n  const navigate = useNavigate();\n  const [selectedArea, setSelectedArea] = useState('Colombo Municipal Council');\n  const [isRouteCreationMode, setIsRouteCreationMode] = useState(false);\n  const [selectedPoints, setSelectedPoints] = useState([]);\n  const [generatedRoutes, setGeneratedRoutes] = useState([]);\n  const [generatedRoute, setGeneratedRoute] = useState(null);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [currentRoadRoute, setCurrentRoadRoute] = useState(null);\n\n  // Load routes from database\n  useEffect(() => {\n    const fetchRoutes = async () => {\n      try {\n        const routes = await routeAPI.getAllRoutes();\n        console.log('Fetched routes:', routes);\n        setGeneratedRoutes(routes);\n      } catch (error) {\n        var _error$response, _error$response$data;\n        console.error(\"Failed to fetch routes:\", error);\n        const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || error.message || 'Unknown error';\n        alert(`Failed to load routes: ${errorMessage}\\n\\nPlease check if the backend server is running on port 5000.`);\n      }\n    };\n    fetchRoutes();\n  }, []);\n\n  // Handle point selection on map\n  const handlePointClick = (point, action = 'add') => {\n    if (action === 'remove') {\n      setSelectedPoints(prev => prev.filter(p => p.id !== point.id));\n    } else {\n      setSelectedPoints(prev => [...prev, point]);\n    }\n  };\n\n  // Simple route optimization algorithm with municipal council as start/end point\n  const optimizeRoute = points => {\n    if (points.length < 2) return points.map(p => p.position);\n\n    // Find the municipal council point for the selected area\n    const municipalPoint = defaultWasteCollectionPoints.find(point => point.municipalCouncil === selectedArea);\n    if (!municipalPoint) {\n      // Fallback to original logic if no municipal point found\n      const unvisited = [...points];\n      const route = [];\n      let current = unvisited.shift();\n      route.push(current.position);\n      while (unvisited.length > 0) {\n        let nearest = unvisited[0];\n        let nearestIndex = 0;\n        let minDistance = getDistance(current.position, nearest.position);\n        for (let i = 1; i < unvisited.length; i++) {\n          const distance = getDistance(current.position, unvisited[i].position);\n          if (distance < minDistance) {\n            minDistance = distance;\n            nearest = unvisited[i];\n            nearestIndex = i;\n          }\n        }\n        route.push(nearest.position);\n        current = nearest;\n        unvisited.splice(nearestIndex, 1);\n      }\n      return route;\n    }\n\n    // Create route starting and ending at municipal council point\n    const startEndPoint = {\n      id: 'municipal-start',\n      position: municipalPoint.position,\n      name: `${municipalPoint.name} (Depot)`\n    };\n\n    // Optimize route through all selected points\n    const unvisited = [...points];\n    const route = [startEndPoint.position]; // Start at municipal point\n\n    // Find nearest point from municipal point to start the collection\n    if (unvisited.length > 0) {\n      let nearest = unvisited[0];\n      let nearestIndex = 0;\n      let minDistance = getDistance(startEndPoint.position, nearest.position);\n      for (let i = 1; i < unvisited.length; i++) {\n        const distance = getDistance(startEndPoint.position, unvisited[i].position);\n        if (distance < minDistance) {\n          minDistance = distance;\n          nearest = unvisited[i];\n          nearestIndex = i;\n        }\n      }\n      let current = nearest;\n      route.push(current.position);\n      unvisited.splice(nearestIndex, 1);\n\n      // Continue with nearest neighbor algorithm\n      while (unvisited.length > 0) {\n        nearest = unvisited[0];\n        nearestIndex = 0;\n        minDistance = getDistance(current.position, nearest.position);\n        for (let i = 1; i < unvisited.length; i++) {\n          const distance = getDistance(current.position, unvisited[i].position);\n          if (distance < minDistance) {\n            minDistance = distance;\n            nearest = unvisited[i];\n            nearestIndex = i;\n          }\n        }\n        route.push(nearest.position);\n        current = nearest;\n        unvisited.splice(nearestIndex, 1);\n      }\n    }\n\n    // Return to municipal point (depot) at the end\n    route.push(startEndPoint.position);\n    return route;\n  };\n\n  // Calculate distance between two points (simple Euclidean distance)\n  const getDistance = (point1, point2) => {\n    const dx = point1[0] - point2[0];\n    const dy = point1[1] - point2[1];\n    return Math.sqrt(dx * dx + dy * dy);\n  };\n\n  // Calculate total route distance for road routes\n  const calculateRoadRouteDistance = roadRoute => {\n    if (!roadRoute || roadRoute.length < 2) return 0;\n    let totalDistance = 0;\n    for (let i = 0; i < roadRoute.length - 1; i++) {\n      totalDistance += getDistance(roadRoute[i], roadRoute[i + 1]);\n    }\n    return (totalDistance * 111.32).toFixed(1); // Convert to approximate km\n  };\n\n  // Calculate total route distance (fallback for straight lines)\n  const calculateRouteDistance = route => {\n    let totalDistance = 0;\n    for (let i = 0; i < route.length - 1; i++) {\n      totalDistance += getDistance(route[i], route[i + 1]);\n    }\n    return (totalDistance * 111.32).toFixed(1); // Convert to approximate km\n  };\n\n  // Handle route deletion\n  const handleDeleteRoute = async routeId => {\n    if (window.confirm('Are you sure you want to delete this route? This action cannot be undone.')) {\n      try {\n        await routeAPI.deleteRoute(routeId);\n        setGeneratedRoutes(prev => prev.filter(route => route.id !== routeId));\n        alert('Route deleted successfully!');\n      } catch (error) {\n        console.error(\"Failed to delete route:\", error);\n        alert('Failed to delete route. Please try again.');\n      }\n    }\n  };\n\n  // Handle route dispatch\n  const handleDispatchRoute = async route => {\n    if (window.confirm(`Are you sure you want to dispatch route ${route.id} to truck ${route.truck}?`)) {\n      try {\n        const updatedRoute = await routeAPI.updateRouteStatus(route.id, {\n          status: 'Dispatched',\n          dispatched: true\n        });\n        setGeneratedRoutes(prev => prev.map(r => r.id === route.id ? updatedRoute : r));\n        alert(`Route ${route.id} has been dispatched to truck ${route.truck}!`);\n      } catch (error) {\n        console.error(\"Failed to dispatch route:\", error);\n        alert('Failed to dispatch route. Please try again.');\n      }\n    }\n  };\n\n  // Handle road route generation callback\n  const handleRoadRouteGenerated = roadRoute => {\n    setCurrentRoadRoute(roadRoute);\n  };\n\n  // Generate unique route ID\n  const generateUniqueRouteId = () => {\n    const existingIds = generatedRoutes.map(route => route.routeId || route.id);\n    let newId;\n    let counter = 101;\n\n    // Keep incrementing until we find a unique ID\n    do {\n      newId = `R-${String(counter).padStart(3, '0')}`;\n      counter++;\n    } while (existingIds.includes(newId));\n    return newId;\n  };\n\n  // Handle route generation\n  const handleGenerateRoutes = () => {\n    if (selectedPoints.length < 2) {\n      alert('Please select at least 2 points to generate a route');\n      return;\n    }\n    setIsGenerating(true);\n\n    // First optimize the point order\n    const optimizedRoute = optimizeRoute(selectedPoints);\n    setGeneratedRoute(optimizedRoute);\n\n    // The road route will be generated automatically by the Map component\n    // Wait for the API calls to complete\n    setTimeout(async () => {\n      const routeDistance = currentRoadRoute ? calculateRoadRouteDistance(currentRoadRoute) : calculateRoadRouteDistance(optimizedRoute);\n      const routeId = generateUniqueRouteId();\n      const truckId = `T-${String(Math.floor(Math.random() * 20) + 1).padStart(2, '0')}`;\n\n      // Create new route object\n      const newRouteData = {\n        routeId: routeId,\n        truck: truckId,\n        municipalCouncil: selectedArea,\n        distance: `${routeDistance} km`,\n        status: 'Optimized',\n        points: selectedPoints.map(p => ({\n          lat: p.position[0],\n          lng: p.position[1],\n          id: p.id\n        })),\n        route: optimizedRoute.map(p => ({\n          lat: p[0],\n          lng: p[1]\n        })),\n        roadRoute: currentRoadRoute ? currentRoadRoute.map(p => ({\n          lat: p[0],\n          lng: p[1]\n        })) : [],\n        dispatched: false\n      };\n      try {\n        console.log('Saving route with data:', newRouteData);\n        const savedRoute = await routeAPI.createRoute(newRouteData);\n        console.log('Route saved successfully:', savedRoute);\n\n        // Refetch all routes to ensure we have the latest list\n        const allRoutes = await routeAPI.getAllRoutes();\n        setGeneratedRoutes(allRoutes);\n        alert('✅ Route created and saved successfully!\\n\\nRoute ID: ' + routeId + '\\nTruck: ' + truckId);\n      } catch (error) {\n        var _error$response2, _error$response4;\n        console.error(\"Failed to save route:\", error);\n\n        // Check if it's a duplicate route ID error\n        if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 409) {\n          var _error$response3, _error$response3$data;\n          const errorMessage = ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || 'This route ID already exists.';\n          alert(`⚠️ Route ID Conflict\\n\\n${errorMessage}\\n\\nPlease try creating the route again - the system will generate a new unique ID.`);\n        } else if (((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status) === 400) {\n          var _error$response5, _error$response5$data;\n          const errorMessage = ((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.error) || 'Invalid route data';\n          alert(`❌ Invalid Data\\n\\n${errorMessage}\\n\\nPlease check your selections and try again.`);\n        } else if (!error.response) {\n          alert(`❌ Connection Error\\n\\nCannot reach the backend server.\\n\\nPlease ensure:\\n1. Backend server is running on port 5001\\n2. You have internet connection\\n3. No firewall is blocking the connection`);\n        } else {\n          var _error$response6, _error$response6$data;\n          const errorMessage = ((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.error) || error.message || 'Unknown error';\n          alert(`❌ Failed to Save Route\\n\\n${errorMessage}\\n\\nPlease try again.`);\n        }\n      } finally {\n        setIsGenerating(false);\n      }\n    }, 3000); // Wait for road routing to complete\n  };\n\n  // Clear route creation\n  const handleClearRoute = () => {\n    setSelectedPoints([]);\n    setGeneratedRoute(null);\n    setCurrentRoadRoute(null);\n    setIsRouteCreationMode(false);\n  };\n\n  // Automatic route generation based on council area\n  const handleAutoGenerateRoute = () => {\n    // First, clear any existing manual selections\n    setSelectedPoints([]);\n    setGeneratedRoute(null);\n    setCurrentRoadRoute(null);\n    setIsGenerating(true);\n    setIsRouteCreationMode(false); // Keep route creation mode OFF for auto-generation\n\n    // Get all bins for the selected council\n    const councilBins = dummyCollectionBins.filter(bin => bin.municipalCouncil === selectedArea);\n    if (councilBins.length === 0) {\n      alert('No collection bins found for the selected council area.');\n      setIsGenerating(false);\n      return;\n    }\n\n    // Get the municipal council depot location\n    const municipalPoint = defaultWasteCollectionPoints.find(point => point.municipalCouncil === selectedArea);\n    if (!municipalPoint) {\n      alert('Municipal council depot not found.');\n      setIsGenerating(false);\n      return;\n    }\n\n    // Calculate distance from depot to each bin\n    const binsWithDistance = councilBins.map(bin => ({\n      ...bin,\n      distanceFromDepot: getDistance(municipalPoint.position, bin.position)\n    }));\n\n    // Sort bins by distance and select closest 8-12 bins\n    const numBinsToSelect = Math.min(10, binsWithDistance.length);\n    const selectedBins = binsWithDistance.sort((a, b) => a.distanceFromDepot - b.distanceFromDepot).slice(0, numBinsToSelect);\n\n    // Convert bins to points format\n    const autoSelectedPoints = selectedBins.map((bin, index) => ({\n      id: bin.id,\n      position: bin.position,\n      name: `Collection Point ${index + 1}`,\n      status: 'selected'\n    }));\n\n    // Temporarily set points for route generation (but keep mode OFF)\n    setSelectedPoints(autoSelectedPoints);\n\n    // Generate the optimized route\n    setTimeout(async () => {\n      const optimizedRoute = optimizeRoute(autoSelectedPoints);\n      setGeneratedRoute(optimizedRoute);\n\n      // Wait for road route generation\n      setTimeout(async () => {\n        const routeDistance = currentRoadRoute ? calculateRoadRouteDistance(currentRoadRoute) : calculateRoadRouteDistance(optimizedRoute);\n        const routeId = generateUniqueRouteId();\n        const truckId = `T-${String(Math.floor(Math.random() * 20) + 1).padStart(2, '0')}`;\n\n        // Create new route object\n        const newRouteData = {\n          routeId: routeId,\n          truck: truckId,\n          municipalCouncil: selectedArea,\n          distance: `${routeDistance} km`,\n          status: 'Optimized',\n          points: autoSelectedPoints.map(p => ({\n            lat: p.position[0],\n            lng: p.position[1],\n            id: p.id\n          })),\n          route: optimizedRoute.map(p => ({\n            lat: p[0],\n            lng: p[1]\n          })),\n          roadRoute: currentRoadRoute ? currentRoadRoute.map(p => ({\n            lat: p[0],\n            lng: p[1]\n          })) : [],\n          dispatched: false\n        };\n        try {\n          console.log('Saving auto-generated route with data:', newRouteData);\n          const savedRoute = await routeAPI.createRoute(newRouteData);\n          console.log('Auto-generated route saved successfully:', savedRoute);\n\n          // Refetch all routes to ensure we have the latest list\n          const allRoutes = await routeAPI.getAllRoutes();\n          setGeneratedRoutes(allRoutes);\n          alert(`✅ Success!\\n\\nRoute created automatically with ${numBinsToSelect} collection points!\\n\\nRoute ID: ${routeId}\\nTruck: ${truckId}\\nDistance: ${routeDistance} km`);\n\n          // Clear the temporary points after saving\n          setSelectedPoints([]);\n          setGeneratedRoute(null);\n          setCurrentRoadRoute(null);\n        } catch (error) {\n          var _error$response7, _error$response9;\n          console.error(\"Failed to save auto-generated route:\", error);\n\n          // Check if it's a duplicate route ID error\n          if (((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : _error$response7.status) === 409) {\n            var _error$response8, _error$response8$data;\n            const errorMessage = ((_error$response8 = error.response) === null || _error$response8 === void 0 ? void 0 : (_error$response8$data = _error$response8.data) === null || _error$response8$data === void 0 ? void 0 : _error$response8$data.message) || 'This route ID already exists.';\n            alert(`⚠️ Route ID Conflict\\n\\n${errorMessage}\\n\\nPlease try generating the route again - the system will create a new unique ID.`);\n          } else if (((_error$response9 = error.response) === null || _error$response9 === void 0 ? void 0 : _error$response9.status) === 400) {\n            var _error$response0, _error$response0$data;\n            const errorMessage = ((_error$response0 = error.response) === null || _error$response0 === void 0 ? void 0 : (_error$response0$data = _error$response0.data) === null || _error$response0$data === void 0 ? void 0 : _error$response0$data.error) || 'Invalid route data';\n            alert(`❌ Invalid Data\\n\\n${errorMessage}\\n\\nPlease check the selected council and try again.`);\n          } else if (!error.response) {\n            alert(`❌ Connection Error\\n\\nCannot reach the backend server.\\n\\nPlease ensure the backend is running on port 5001.`);\n          } else {\n            var _error$response1, _error$response1$data;\n            const errorMessage = ((_error$response1 = error.response) === null || _error$response1 === void 0 ? void 0 : (_error$response1$data = _error$response1.data) === null || _error$response1$data === void 0 ? void 0 : _error$response1$data.error) || error.message || 'Unknown error';\n            alert(`❌ Auto-Generate Failed\\n\\n${errorMessage}\\n\\nPlease try again.`);\n          }\n        } finally {\n          setIsGenerating(false);\n        }\n      }, 3000); // Wait for road routing to complete\n    }, 500);\n  };\n\n  // Toggle route creation mode\n  const toggleRouteCreationMode = () => {\n    setIsRouteCreationMode(prev => !prev);\n    if (isRouteCreationMode) {\n      handleClearRoute();\n    }\n  };\n  const handleLatestRouteNav = async () => {\n    try {\n      const latestRoute = await routeAPI.getLatestRoute();\n      if (latestRoute && latestRoute._id) {\n        navigate(`/route-details/${latestRoute._id}`);\n      } else {\n        alert('No routes available to show details for.');\n      }\n    } catch (error) {\n      alert('Failed to fetch the latest route.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-50 text-gray-900 flex\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"w-64 bg-white shadow-md flex flex-col\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => navigate('/'),\n        className: \"p-6 flex items-center gap-4 border-b cursor-pointer\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-10 h-10 rounded-lg bg-gradient-to-br from-green-400 to-emerald-600 flex items-center justify-center shadow-md\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"22\",\n            height: \"22\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M3 12h4l2-3 3 6 3-8 4 8\",\n              stroke: \"white\",\n              strokeWidth: \"1.5\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-lg font-semibold\",\n            children: \"EcoCollect\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 443,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-500 -mt-0.5\",\n            children: \"Operator Dashboard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"nav\", {\n        className: \"flex-1 p-4 space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"#\",\n          onClick: () => navigate('/dashboard'),\n          className: \"flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-100\",\n          children: \"Dashboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"#\",\n          onClick: () => navigate('/routes'),\n          className: \"flex items-center gap-3 px-4 py-2 rounded-lg bg-emerald-50 text-emerald-700 font-semibold\",\n          children: \"Routes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"#\",\n          onClick: handleLatestRouteNav,\n          className: \"flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-100\",\n          children: \"Route Details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex flex-col\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"bg-white shadow-sm p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-semibold\",\n          children: \"Optimize Collection Routes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"flex-1 p-6 flex flex-col lg:flex-row gap-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full lg:w-1/3 bg-white p-6 rounded-xl border border-gray-100 shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-lg font-semibold\",\n            children: \"Control Panel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-4 space-y-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"area\",\n                className: \"block text-sm font-medium text-gray-700\",\n                children: \"Select Municipal Council\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                id: \"area\",\n                value: selectedArea,\n                onChange: e => setSelectedArea(e.target.value),\n                className: \"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md\",\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Colombo Municipal Council\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 473,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Dehiwala-Mount Lavinia Municipal Council\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 474,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Sri Jayawardenapura Kotte Municipal Council\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 475,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Kaduwela Municipal Council\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 476,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 467,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: toggleRouteCreationMode,\n                className: `w-full px-4 py-2 rounded-md font-semibold shadow transition ${isRouteCreationMode ? 'bg-red-600 text-white hover:bg-red-700' : 'bg-emerald-600 text-white hover:bg-emerald-700'}`,\n                children: isRouteCreationMode ? 'Cancel Route Creation' : 'Create New Route'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleAutoGenerateRoute,\n                disabled: isGenerating,\n                className: `w-full px-4 py-3 rounded-lg font-semibold shadow-lg transition-all duration-300 relative overflow-hidden ${isGenerating ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white hover:shadow-xl hover:scale-105 hover:from-purple-700 hover:via-blue-700 hover:to-indigo-700'}`,\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"flex items-center justify-center gap-2\",\n                  children: isGenerating ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                      className: \"animate-spin h-5 w-5\",\n                      xmlns: \"http://www.w3.org/2000/svg\",\n                      fill: \"none\",\n                      viewBox: \"0 0 24 24\",\n                      children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                        className: \"opacity-25\",\n                        cx: \"12\",\n                        cy: \"12\",\n                        r: \"10\",\n                        stroke: \"currentColor\",\n                        strokeWidth: \"4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 505,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                        className: \"opacity-75\",\n                        fill: \"currentColor\",\n                        d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 506,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 504,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"AI Generating Route...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 508,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                      className: \"w-5 h-5\",\n                      fill: \"none\",\n                      stroke: \"currentColor\",\n                      viewBox: \"0 0 24 24\",\n                      xmlns: \"http://www.w3.org/2000/svg\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        strokeLinecap: \"round\",\n                        strokeLinejoin: \"round\",\n                        strokeWidth: \"2\",\n                        d: \"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 513,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 512,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"AI Auto-Generate Route\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 515,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n                      className: \"w-4 h-4 opacity-70\",\n                      fill: \"currentColor\",\n                      viewBox: \"0 0 20 20\",\n                      xmlns: \"http://www.w3.org/2000/svg\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        fillRule: \"evenodd\",\n                        d: \"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z\",\n                        clipRule: \"evenodd\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 517,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 516,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 501,\n                  columnNumber: 19\n                }, this), !isGenerating && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-10 transition-opacity\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"absolute inset-0 bg-white rounded-lg\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 524,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 523,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 17\n              }, this), isRouteCreationMode && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm text-gray-600 bg-emerald-50 p-3 rounded\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"font-medium\",\n                    children: [\"Selected Points: \", selectedPoints.length]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 532,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs mt-1\",\n                    children: \"Click on the map to add collection points\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 533,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 531,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleGenerateRoutes,\n                  disabled: selectedPoints.length < 2 || isGenerating,\n                  className: `w-full px-4 py-2 rounded-md font-semibold shadow transition ${selectedPoints.length < 2 || isGenerating ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-emerald-600 text-white hover:bg-emerald-700'}`,\n                  children: isGenerating ? 'Generating...' : 'Generate Route'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 536,\n                  columnNumber: 21\n                }, this), selectedPoints.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleClearRoute,\n                  className: \"w-full px-4 py-2 rounded-md bg-gray-500 text-white font-semibold shadow hover:bg-gray-600 transition\",\n                  children: \"Clear Points\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 549,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full lg:w-2/3 bg-white p-6 rounded-xl border border-gray-100 shadow-sm\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-96\",\n            children: /*#__PURE__*/_jsxDEV(Map, {\n              selectedArea: selectedArea,\n              isRouteCreationMode: isRouteCreationMode,\n              selectedPoints: selectedPoints,\n              onPointClick: handlePointClick,\n              generatedRoute: generatedRoute,\n              showDefaultPoints: !isRouteCreationMode,\n              onRouteGenerated: handleRoadRouteGenerated\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 565,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 563,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white p-6 rounded-xl border border-gray-100 shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-lg font-semibold\",\n              children: \"Generated Routes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 582,\n              columnNumber: 19\n            }, this), generatedRoutes.length > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm text-gray-500\",\n              children: [\"Total Routes: \", generatedRoutes.length]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 584,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 17\n          }, this), generatedRoutes.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center py-8 text-gray-500\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg\",\n              children: \"No routes generated yet\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 592,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm mt-1\",\n              children: \"Create a new route by clicking points on the map\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 593,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 591,\n            columnNumber: 19\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"overflow-x-auto\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"w-full text-sm text-left text-gray-500\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                className: \"text-xs text-gray-700 uppercase bg-gray-50\",\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    className: \"px-6 py-3\",\n                    children: \"Route ID\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 600,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    className: \"px-6 py-3\",\n                    children: \"Truck\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 601,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    className: \"px-6 py-3\",\n                    children: \"Municipal Council\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 602,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    className: \"px-6 py-3\",\n                    children: \"Distance\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 603,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    className: \"px-6 py-3\",\n                    children: \"Est. Time\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 604,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    className: \"px-6 py-3\",\n                    children: \"Status\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 605,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    className: \"px-6 py-3\",\n                    children: \"Actions\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 606,\n                    columnNumber: 33\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 599,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 598,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: generatedRoutes.map(route => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"bg-white border-b hover:bg-gray-50\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    onClick: () => navigate(`/route-details/${route._id}`),\n                    className: \"px-6 py-4 font-medium text-emerald-600 hover:underline cursor-pointer\",\n                    children: route.routeId\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 612,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-6 py-4\",\n                    children: route.truck\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 618,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-6 py-4\",\n                    children: route.municipalCouncil\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 619,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-6 py-4\",\n                    children: route.distance\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 620,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-6 py-4\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-blue-600 font-medium\",\n                      children: route.estimatedTime || 'N/A'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 622,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 621,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-6 py-4\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-green-600 bg-green-100 px-2 py-1 rounded-full text-xs\",\n                      children: route.status\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 627,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 626,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-6 py-4\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex gap-2\",\n                      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => handleDispatchRoute(route),\n                        className: \"font-medium text-emerald-600 hover:underline\",\n                        children: \"Dispatch\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 633,\n                        columnNumber: 39\n                      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => handleDeleteRoute(route._id),\n                        className: \"font-medium text-red-600 hover:underline\",\n                        children: \"Delete\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 639,\n                        columnNumber: 39\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 632,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 631,\n                    columnNumber: 35\n                  }, this)]\n                }, route._id || route.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 611,\n                  columnNumber: 31\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 609,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 596,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 433,\n    columnNumber: 5\n  }, this);\n}\n_s(RouteOptimizationPage, \"0wV2DXfUbX8oAnKFBfhJ4bY7wW8=\", false, function () {\n  return [useNavigate];\n});\n_c = RouteOptimizationPage;\nvar _c;\n$RefreshReg$(_c, \"RouteOptimizationPage\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Map","defaultWasteCollectionPoints","dummyCollectionBins","routeAPI","jsxDEV","_jsxDEV","Fragment","_Fragment","RouteOptimizationPage","_s","navigate","selectedArea","setSelectedArea","isRouteCreationMode","setIsRouteCreationMode","selectedPoints","setSelectedPoints","generatedRoutes","setGeneratedRoutes","generatedRoute","setGeneratedRoute","isGenerating","setIsGenerating","currentRoadRoute","setCurrentRoadRoute","fetchRoutes","routes","getAllRoutes","console","log","error","_error$response","_error$response$data","errorMessage","response","data","message","alert","handlePointClick","point","action","prev","filter","p","id","optimizeRoute","points","length","map","position","municipalPoint","find","municipalCouncil","unvisited","route","current","shift","push","nearest","nearestIndex","minDistance","getDistance","i","distance","splice","startEndPoint","name","point1","point2","dx","dy","Math","sqrt","calculateRoadRouteDistance","roadRoute","totalDistance","toFixed","calculateRouteDistance","handleDeleteRoute","routeId","window","confirm","deleteRoute","handleDispatchRoute","truck","updatedRoute","updateRouteStatus","status","dispatched","r","handleRoadRouteGenerated","generateUniqueRouteId","existingIds","newId","counter","String","padStart","includes","handleGenerateRoutes","optimizedRoute","setTimeout","routeDistance","truckId","floor","random","newRouteData","lat","lng","savedRoute","createRoute","allRoutes","_error$response2","_error$response4","_error$response3","_error$response3$data","_error$response5","_error$response5$data","_error$response6","_error$response6$data","handleClearRoute","handleAutoGenerateRoute","councilBins","bin","binsWithDistance","distanceFromDepot","numBinsToSelect","min","selectedBins","sort","a","b","slice","autoSelectedPoints","index","_error$response7","_error$response9","_error$response8","_error$response8$data","_error$response0","_error$response0$data","_error$response1","_error$response1$data","toggleRouteCreationMode","handleLatestRouteNav","latestRoute","getLatestRoute","_id","className","children","onClick","width","height","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin","fileName","_jsxFileName","lineNumber","columnNumber","href","htmlFor","value","onChange","e","target","disabled","cx","cy","fillRule","clipRule","onPointClick","showDefaultPoints","onRouteGenerated","scope","estimatedTime","_c","$RefreshReg$"],"sources":["C:/Users/lahiru deshan/Desktop/CropWise_GitHub/EcoCollect/apps/frontend/src/pages/RouteOptimizationPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Map, { defaultWasteCollectionPoints, dummyCollectionBins } from '../components/Map';\r\nimport { routeAPI } from '../services/api';\r\n\r\nexport default function RouteOptimizationPage() {\r\n  const navigate = useNavigate();\r\n  const [selectedArea, setSelectedArea] = useState('Colombo Municipal Council');\r\n  const [isRouteCreationMode, setIsRouteCreationMode] = useState(false);\r\n  const [selectedPoints, setSelectedPoints] = useState([]);\r\n  const [generatedRoutes, setGeneratedRoutes] = useState([]);\r\n  const [generatedRoute, setGeneratedRoute] = useState(null);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [currentRoadRoute, setCurrentRoadRoute] = useState(null);\r\n\r\n  // Load routes from database\r\n  useEffect(() => {\r\n    const fetchRoutes = async () => {\r\n      try {\r\n        const routes = await routeAPI.getAllRoutes();\r\n        console.log('Fetched routes:', routes);\r\n        setGeneratedRoutes(routes);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch routes:\", error);\r\n        const errorMessage = error.response?.data?.error || error.message || 'Unknown error';\r\n        alert(`Failed to load routes: ${errorMessage}\\n\\nPlease check if the backend server is running on port 5000.`);\r\n      }\r\n    };\r\n    fetchRoutes();\r\n  }, []);\r\n\r\n  // Handle point selection on map\r\n  const handlePointClick = (point, action = 'add') => {\r\n    if (action === 'remove') {\r\n      setSelectedPoints(prev => prev.filter(p => p.id !== point.id));\r\n    } else {\r\n      setSelectedPoints(prev => [...prev, point]);\r\n    }\r\n  };\r\n\r\n  // Simple route optimization algorithm with municipal council as start/end point\r\n  const optimizeRoute = (points) => {\r\n    if (points.length < 2) return points.map(p => p.position);\r\n    \r\n    // Find the municipal council point for the selected area\r\n    const municipalPoint = defaultWasteCollectionPoints.find(\r\n      point => point.municipalCouncil === selectedArea\r\n    );\r\n    \r\n    if (!municipalPoint) {\r\n      // Fallback to original logic if no municipal point found\r\n      const unvisited = [...points];\r\n      const route = [];\r\n      let current = unvisited.shift();\r\n      route.push(current.position);\r\n      \r\n      while (unvisited.length > 0) {\r\n        let nearest = unvisited[0];\r\n        let nearestIndex = 0;\r\n        let minDistance = getDistance(current.position, nearest.position);\r\n        \r\n        for (let i = 1; i < unvisited.length; i++) {\r\n          const distance = getDistance(current.position, unvisited[i].position);\r\n          if (distance < minDistance) {\r\n            minDistance = distance;\r\n            nearest = unvisited[i];\r\n            nearestIndex = i;\r\n          }\r\n        }\r\n        \r\n        route.push(nearest.position);\r\n        current = nearest;\r\n        unvisited.splice(nearestIndex, 1);\r\n      }\r\n      \r\n      return route;\r\n    }\r\n    \r\n    // Create route starting and ending at municipal council point\r\n    const startEndPoint = { \r\n      id: 'municipal-start', \r\n      position: municipalPoint.position, \r\n      name: `${municipalPoint.name} (Depot)` \r\n    };\r\n    \r\n    // Optimize route through all selected points\r\n    const unvisited = [...points];\r\n    const route = [startEndPoint.position]; // Start at municipal point\r\n    \r\n    // Find nearest point from municipal point to start the collection\r\n    if (unvisited.length > 0) {\r\n      let nearest = unvisited[0];\r\n      let nearestIndex = 0;\r\n      let minDistance = getDistance(startEndPoint.position, nearest.position);\r\n      \r\n      for (let i = 1; i < unvisited.length; i++) {\r\n        const distance = getDistance(startEndPoint.position, unvisited[i].position);\r\n        if (distance < minDistance) {\r\n          minDistance = distance;\r\n          nearest = unvisited[i];\r\n          nearestIndex = i;\r\n        }\r\n      }\r\n      \r\n      let current = nearest;\r\n      route.push(current.position);\r\n      unvisited.splice(nearestIndex, 1);\r\n      \r\n      // Continue with nearest neighbor algorithm\r\n      while (unvisited.length > 0) {\r\n        nearest = unvisited[0];\r\n        nearestIndex = 0;\r\n        minDistance = getDistance(current.position, nearest.position);\r\n        \r\n        for (let i = 1; i < unvisited.length; i++) {\r\n          const distance = getDistance(current.position, unvisited[i].position);\r\n          if (distance < minDistance) {\r\n            minDistance = distance;\r\n            nearest = unvisited[i];\r\n            nearestIndex = i;\r\n          }\r\n        }\r\n        \r\n        route.push(nearest.position);\r\n        current = nearest;\r\n        unvisited.splice(nearestIndex, 1);\r\n      }\r\n    }\r\n    \r\n    // Return to municipal point (depot) at the end\r\n    route.push(startEndPoint.position);\r\n    \r\n    return route;\r\n  };\r\n\r\n  // Calculate distance between two points (simple Euclidean distance)\r\n  const getDistance = (point1, point2) => {\r\n    const dx = point1[0] - point2[0];\r\n    const dy = point1[1] - point2[1];\r\n    return Math.sqrt(dx * dx + dy * dy);\r\n  };\r\n\r\n  // Calculate total route distance for road routes\r\n  const calculateRoadRouteDistance = (roadRoute) => {\r\n    if (!roadRoute || roadRoute.length < 2) return 0;\r\n    \r\n    let totalDistance = 0;\r\n    for (let i = 0; i < roadRoute.length - 1; i++) {\r\n      totalDistance += getDistance(roadRoute[i], roadRoute[i + 1]);\r\n    }\r\n    return (totalDistance * 111.32).toFixed(1); // Convert to approximate km\r\n  };\r\n\r\n  // Calculate total route distance (fallback for straight lines)\r\n  const calculateRouteDistance = (route) => {\r\n    let totalDistance = 0;\r\n    for (let i = 0; i < route.length - 1; i++) {\r\n      totalDistance += getDistance(route[i], route[i + 1]);\r\n    }\r\n    return (totalDistance * 111.32).toFixed(1); // Convert to approximate km\r\n  };\r\n\r\n  // Handle route deletion\r\n  const handleDeleteRoute = async (routeId) => {\r\n    if (window.confirm('Are you sure you want to delete this route? This action cannot be undone.')) {\r\n      try {\r\n        await routeAPI.deleteRoute(routeId);\r\n        setGeneratedRoutes(prev => prev.filter(route => route.id !== routeId));\r\n        alert('Route deleted successfully!');\r\n      } catch (error) {\r\n        console.error(\"Failed to delete route:\", error);\r\n        alert('Failed to delete route. Please try again.');\r\n      }\r\n    }\r\n  };\r\n\r\n  // Handle route dispatch\r\n  const handleDispatchRoute = async (route) => {\r\n    if (window.confirm(`Are you sure you want to dispatch route ${route.id} to truck ${route.truck}?`)) {\r\n      try {\r\n        const updatedRoute = await routeAPI.updateRouteStatus(route.id, { \r\n          status: 'Dispatched',\r\n          dispatched: true,\r\n        });\r\n        setGeneratedRoutes(prev => \r\n          prev.map(r => (r.id === route.id ? updatedRoute : r))\r\n        );\r\n        alert(`Route ${route.id} has been dispatched to truck ${route.truck}!`);\r\n      } catch (error) {\r\n        console.error(\"Failed to dispatch route:\", error);\r\n        alert('Failed to dispatch route. Please try again.');\r\n      }\r\n    }\r\n  };\r\n\r\n  // Handle road route generation callback\r\n  const handleRoadRouteGenerated = (roadRoute) => {\r\n    setCurrentRoadRoute(roadRoute);\r\n  };\r\n\r\n  // Generate unique route ID\r\n  const generateUniqueRouteId = () => {\r\n    const existingIds = generatedRoutes.map(route => route.routeId || route.id);\r\n    let newId;\r\n    let counter = 101;\r\n    \r\n    // Keep incrementing until we find a unique ID\r\n    do {\r\n      newId = `R-${String(counter).padStart(3, '0')}`;\r\n      counter++;\r\n    } while (existingIds.includes(newId));\r\n    \r\n    return newId;\r\n  };\r\n\r\n  // Handle route generation\r\n  const handleGenerateRoutes = () => {\r\n    if (selectedPoints.length < 2) {\r\n      alert('Please select at least 2 points to generate a route');\r\n      return;\r\n    }\r\n\r\n    setIsGenerating(true);\r\n    \r\n    // First optimize the point order\r\n    const optimizedRoute = optimizeRoute(selectedPoints);\r\n    setGeneratedRoute(optimizedRoute);\r\n    \r\n    // The road route will be generated automatically by the Map component\r\n    // Wait for the API calls to complete\r\n    setTimeout(async () => {\r\n      const routeDistance = currentRoadRoute ? \r\n        calculateRoadRouteDistance(currentRoadRoute) : \r\n        calculateRoadRouteDistance(optimizedRoute);\r\n      \r\n      const routeId = generateUniqueRouteId();\r\n      const truckId = `T-${String(Math.floor(Math.random() * 20) + 1).padStart(2, '0')}`;\r\n      \r\n      // Create new route object\r\n      const newRouteData = {\r\n        routeId: routeId,\r\n        truck: truckId,\r\n        municipalCouncil: selectedArea,\r\n        distance: `${routeDistance} km`,\r\n        status: 'Optimized',\r\n        points: selectedPoints.map(p => ({ lat: p.position[0], lng: p.position[1], id: p.id })),\r\n        route: optimizedRoute.map(p => ({ lat: p[0], lng: p[1] })),\r\n        roadRoute: currentRoadRoute ? currentRoadRoute.map(p => ({ lat: p[0], lng: p[1] })) : [],\r\n        dispatched: false\r\n      };\r\n\r\n      try {\r\n        console.log('Saving route with data:', newRouteData);\r\n        const savedRoute = await routeAPI.createRoute(newRouteData);\r\n        console.log('Route saved successfully:', savedRoute);\r\n        \r\n        // Refetch all routes to ensure we have the latest list\r\n        const allRoutes = await routeAPI.getAllRoutes();\r\n        setGeneratedRoutes(allRoutes);\r\n        \r\n        alert('✅ Route created and saved successfully!\\n\\nRoute ID: ' + routeId + '\\nTruck: ' + truckId);\r\n      } catch (error) {\r\n        console.error(\"Failed to save route:\", error);\r\n        \r\n        // Check if it's a duplicate route ID error\r\n        if (error.response?.status === 409) {\r\n          const errorMessage = error.response?.data?.message || 'This route ID already exists.';\r\n          alert(`⚠️ Route ID Conflict\\n\\n${errorMessage}\\n\\nPlease try creating the route again - the system will generate a new unique ID.`);\r\n        } else if (error.response?.status === 400) {\r\n          const errorMessage = error.response?.data?.error || 'Invalid route data';\r\n          alert(`❌ Invalid Data\\n\\n${errorMessage}\\n\\nPlease check your selections and try again.`);\r\n        } else if (!error.response) {\r\n          alert(`❌ Connection Error\\n\\nCannot reach the backend server.\\n\\nPlease ensure:\\n1. Backend server is running on port 5001\\n2. You have internet connection\\n3. No firewall is blocking the connection`);\r\n        } else {\r\n          const errorMessage = error.response?.data?.error || error.message || 'Unknown error';\r\n          alert(`❌ Failed to Save Route\\n\\n${errorMessage}\\n\\nPlease try again.`);\r\n        }\r\n      } finally {\r\n        setIsGenerating(false);\r\n      }\r\n    }, 3000); // Wait for road routing to complete\r\n  };\r\n\r\n  // Clear route creation\r\n  const handleClearRoute = () => {\r\n    setSelectedPoints([]);\r\n    setGeneratedRoute(null);\r\n    setCurrentRoadRoute(null);\r\n    setIsRouteCreationMode(false);\r\n  };\r\n\r\n  // Automatic route generation based on council area\r\n  const handleAutoGenerateRoute = () => {\r\n    // First, clear any existing manual selections\r\n    setSelectedPoints([]);\r\n    setGeneratedRoute(null);\r\n    setCurrentRoadRoute(null);\r\n    \r\n    setIsGenerating(true);\r\n    setIsRouteCreationMode(false); // Keep route creation mode OFF for auto-generation\r\n    \r\n    // Get all bins for the selected council\r\n    const councilBins = dummyCollectionBins.filter(\r\n      bin => bin.municipalCouncil === selectedArea\r\n    );\r\n    \r\n    if (councilBins.length === 0) {\r\n      alert('No collection bins found for the selected council area.');\r\n      setIsGenerating(false);\r\n      return;\r\n    }\r\n    \r\n    // Get the municipal council depot location\r\n    const municipalPoint = defaultWasteCollectionPoints.find(\r\n      point => point.municipalCouncil === selectedArea\r\n    );\r\n    \r\n    if (!municipalPoint) {\r\n      alert('Municipal council depot not found.');\r\n      setIsGenerating(false);\r\n      return;\r\n    }\r\n    \r\n    // Calculate distance from depot to each bin\r\n    const binsWithDistance = councilBins.map(bin => ({\r\n      ...bin,\r\n      distanceFromDepot: getDistance(municipalPoint.position, bin.position)\r\n    }));\r\n    \r\n    // Sort bins by distance and select closest 8-12 bins\r\n    const numBinsToSelect = Math.min(10, binsWithDistance.length);\r\n    const selectedBins = binsWithDistance\r\n      .sort((a, b) => a.distanceFromDepot - b.distanceFromDepot)\r\n      .slice(0, numBinsToSelect);\r\n    \r\n    // Convert bins to points format\r\n    const autoSelectedPoints = selectedBins.map((bin, index) => ({\r\n      id: bin.id,\r\n      position: bin.position,\r\n      name: `Collection Point ${index + 1}`,\r\n      status: 'selected'\r\n    }));\r\n    \r\n    // Temporarily set points for route generation (but keep mode OFF)\r\n    setSelectedPoints(autoSelectedPoints);\r\n    \r\n    // Generate the optimized route\r\n    setTimeout(async () => {\r\n      const optimizedRoute = optimizeRoute(autoSelectedPoints);\r\n      setGeneratedRoute(optimizedRoute);\r\n      \r\n      // Wait for road route generation\r\n      setTimeout(async () => {\r\n        const routeDistance = currentRoadRoute ? \r\n          calculateRoadRouteDistance(currentRoadRoute) : \r\n          calculateRoadRouteDistance(optimizedRoute);\r\n        \r\n        const routeId = generateUniqueRouteId();\r\n        const truckId = `T-${String(Math.floor(Math.random() * 20) + 1).padStart(2, '0')}`;\r\n        \r\n        // Create new route object\r\n        const newRouteData = {\r\n          routeId: routeId,\r\n          truck: truckId,\r\n          municipalCouncil: selectedArea,\r\n          distance: `${routeDistance} km`,\r\n          status: 'Optimized',\r\n          points: autoSelectedPoints.map(p => ({ lat: p.position[0], lng: p.position[1], id: p.id })),\r\n          route: optimizedRoute.map(p => ({ lat: p[0], lng: p[1] })),\r\n          roadRoute: currentRoadRoute ? currentRoadRoute.map(p => ({ lat: p[0], lng: p[1] })) : [],\r\n          dispatched: false\r\n        };\r\n\r\n        try {\r\n          console.log('Saving auto-generated route with data:', newRouteData);\r\n          const savedRoute = await routeAPI.createRoute(newRouteData);\r\n          console.log('Auto-generated route saved successfully:', savedRoute);\r\n          \r\n          // Refetch all routes to ensure we have the latest list\r\n          const allRoutes = await routeAPI.getAllRoutes();\r\n          setGeneratedRoutes(allRoutes);\r\n          \r\n          alert(`✅ Success!\\n\\nRoute created automatically with ${numBinsToSelect} collection points!\\n\\nRoute ID: ${routeId}\\nTruck: ${truckId}\\nDistance: ${routeDistance} km`);\r\n          \r\n          // Clear the temporary points after saving\r\n          setSelectedPoints([]);\r\n          setGeneratedRoute(null);\r\n          setCurrentRoadRoute(null);\r\n        } catch (error) {\r\n          console.error(\"Failed to save auto-generated route:\", error);\r\n          \r\n          // Check if it's a duplicate route ID error\r\n          if (error.response?.status === 409) {\r\n            const errorMessage = error.response?.data?.message || 'This route ID already exists.';\r\n            alert(`⚠️ Route ID Conflict\\n\\n${errorMessage}\\n\\nPlease try generating the route again - the system will create a new unique ID.`);\r\n          } else if (error.response?.status === 400) {\r\n            const errorMessage = error.response?.data?.error || 'Invalid route data';\r\n            alert(`❌ Invalid Data\\n\\n${errorMessage}\\n\\nPlease check the selected council and try again.`);\r\n          } else if (!error.response) {\r\n            alert(`❌ Connection Error\\n\\nCannot reach the backend server.\\n\\nPlease ensure the backend is running on port 5001.`);\r\n          } else {\r\n            const errorMessage = error.response?.data?.error || error.message || 'Unknown error';\r\n            alert(`❌ Auto-Generate Failed\\n\\n${errorMessage}\\n\\nPlease try again.`);\r\n          }\r\n        } finally {\r\n          setIsGenerating(false);\r\n        }\r\n      }, 3000); // Wait for road routing to complete\r\n    }, 500);\r\n  };\r\n\r\n  // Toggle route creation mode\r\n  const toggleRouteCreationMode = () => {\r\n    setIsRouteCreationMode(prev => !prev);\r\n    if (isRouteCreationMode) {\r\n      handleClearRoute();\r\n    }\r\n  };\r\n  const handleLatestRouteNav = async () => {\r\n    try {\r\n      const latestRoute = await routeAPI.getLatestRoute();\r\n      if (latestRoute && latestRoute._id) {\r\n        navigate(`/route-details/${latestRoute._id}`);\r\n      } else {\r\n        alert('No routes available to show details for.');\r\n      }\r\n    } catch (error) {\r\n      alert('Failed to fetch the latest route.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 text-gray-900 flex\">\r\n      {/* Sidebar */}\r\n      <aside className=\"w-64 bg-white shadow-md flex flex-col\">\r\n        <div onClick={() => navigate('/')} className=\"p-6 flex items-center gap-4 border-b cursor-pointer\">\r\n          <div className=\"w-10 h-10 rounded-lg bg-gradient-to-br from-green-400 to-emerald-600 flex items-center justify-center shadow-md\">\r\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n              <path d=\"M3 12h4l2-3 3 6 3-8 4 8\" stroke=\"white\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n            </svg>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-lg font-semibold\">EcoCollect</div>\r\n            <div className=\"text-xs text-gray-500 -mt-0.5\">Operator Dashboard</div>\r\n          </div>\r\n        </div>\r\n        <nav className=\"flex-1 p-4 space-y-2\">\r\n          <a href=\"#\" onClick={() => navigate('/dashboard')} className=\"flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-100\">Dashboard</a>\r\n          <a href=\"#\" onClick={() => navigate('/routes')} className=\"flex items-center gap-3 px-4 py-2 rounded-lg bg-emerald-50 text-emerald-700 font-semibold\">Routes</a>\r\n          <a href=\"#\" onClick={handleLatestRouteNav} className=\"flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-100\">Route Details</a>\r\n        </nav>\r\n      </aside>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 flex flex-col\">\r\n        <header className=\"bg-white shadow-sm p-4\">\r\n          <h1 className=\"text-xl font-semibold\">Optimize Collection Routes</h1>\r\n        </header>\r\n\r\n        <main className=\"flex-1 p-6 flex flex-col lg:flex-row gap-6\">\r\n          {/* Left Panel: Controls */}\r\n          <div className=\"w-full lg:w-1/3 bg-white p-6 rounded-xl border border-gray-100 shadow-sm\">\r\n            <h2 className=\"text-lg font-semibold\">Control Panel</h2>\r\n            <div className=\"mt-4 space-y-4\">\r\n              <div>\r\n                <label htmlFor=\"area\" className=\"block text-sm font-medium text-gray-700\">Select Municipal Council</label>\r\n                <select \r\n                  id=\"area\" \r\n                  value={selectedArea}\r\n                  onChange={(e) => setSelectedArea(e.target.value)}\r\n                  className=\"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md\"\r\n                >\r\n                  <option>Colombo Municipal Council</option>\r\n                  <option>Dehiwala-Mount Lavinia Municipal Council</option>\r\n                  <option>Sri Jayawardenapura Kotte Municipal Council</option>\r\n                  <option>Kaduwela Municipal Council</option>\r\n                </select>\r\n              </div>\r\n              \r\n              <div className=\"space-y-2\">\r\n                <button \r\n                  onClick={toggleRouteCreationMode}\r\n                  className={`w-full px-4 py-2 rounded-md font-semibold shadow transition ${\r\n                    isRouteCreationMode \r\n                      ? 'bg-red-600 text-white hover:bg-red-700' \r\n                      : 'bg-emerald-600 text-white hover:bg-emerald-700'\r\n                  }`}\r\n                >\r\n                  {isRouteCreationMode ? 'Cancel Route Creation' : 'Create New Route'}\r\n                </button>\r\n                \r\n                <button \r\n                  onClick={handleAutoGenerateRoute}\r\n                  disabled={isGenerating}\r\n                  className={`w-full px-4 py-3 rounded-lg font-semibold shadow-lg transition-all duration-300 relative overflow-hidden ${\r\n                    isGenerating\r\n                      ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                      : 'bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white hover:shadow-xl hover:scale-105 hover:from-purple-700 hover:via-blue-700 hover:to-indigo-700'\r\n                  }`}\r\n                >\r\n                  <span className=\"flex items-center justify-center gap-2\">\r\n                    {isGenerating ? (\r\n                      <>\r\n                        <svg className=\"animate-spin h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                        </svg>\r\n                        <span>AI Generating Route...</span>\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"></path>\r\n                        </svg>\r\n                        <span>AI Auto-Generate Route</span>\r\n                        <svg className=\"w-4 h-4 opacity-70\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                          <path fillRule=\"evenodd\" d=\"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z\" clipRule=\"evenodd\"></path>\r\n                        </svg>\r\n                      </>\r\n                    )}\r\n                  </span>\r\n                  {!isGenerating && (\r\n                    <span className=\"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-10 transition-opacity\">\r\n                      <span className=\"absolute inset-0 bg-white rounded-lg\"></span>\r\n                    </span>\r\n                  )}\r\n                </button>\r\n                \r\n                {isRouteCreationMode && (\r\n                  <>\r\n                    <div className=\"text-sm text-gray-600 bg-emerald-50 p-3 rounded\">\r\n                      <p className=\"font-medium\">Selected Points: {selectedPoints.length}</p>\r\n                      <p className=\"text-xs mt-1\">Click on the map to add collection points</p>\r\n                    </div>\r\n                    \r\n                    <button \r\n                      onClick={handleGenerateRoutes}\r\n                      disabled={selectedPoints.length < 2 || isGenerating}\r\n                      className={`w-full px-4 py-2 rounded-md font-semibold shadow transition ${\r\n                        selectedPoints.length < 2 || isGenerating\r\n                          ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                          : 'bg-emerald-600 text-white hover:bg-emerald-700'\r\n                      }`}\r\n                    >\r\n                      {isGenerating ? 'Generating...' : 'Generate Route'}\r\n                    </button>\r\n                    \r\n                    {selectedPoints.length > 0 && (\r\n                      <button \r\n                        onClick={handleClearRoute}\r\n                        className=\"w-full px-4 py-2 rounded-md bg-gray-500 text-white font-semibold shadow hover:bg-gray-600 transition\"\r\n                      >\r\n                        Clear Points\r\n                      </button>\r\n                    )}\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right Panel: Map */}\r\n          <div className=\"w-full lg:w-2/3 bg-white p-6 rounded-xl border border-gray-100 shadow-sm\">\r\n            <div className=\"h-96\">\r\n              <Map \r\n                selectedArea={selectedArea}\r\n                isRouteCreationMode={isRouteCreationMode}\r\n                selectedPoints={selectedPoints}\r\n                onPointClick={handlePointClick}\r\n                generatedRoute={generatedRoute}\r\n                showDefaultPoints={!isRouteCreationMode}\r\n                onRouteGenerated={handleRoadRouteGenerated}\r\n              />\r\n            </div>\r\n          </div>\r\n        </main>\r\n\r\n        {/* Bottom Panel: Route Table */}\r\n        <div className=\"p-6\">\r\n            <div className=\"bg-white p-6 rounded-xl border border-gray-100 shadow-sm\">\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <h2 className=\"text-lg font-semibold\">Generated Routes</h2>\r\n                  {generatedRoutes.length > 0 && (\r\n                    <span className=\"text-sm text-gray-500\">\r\n                      Total Routes: {generatedRoutes.length}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                \r\n                {generatedRoutes.length === 0 ? (\r\n                  <div className=\"text-center py-8 text-gray-500\">\r\n                    <p className=\"text-lg\">No routes generated yet</p>\r\n                    <p className=\"text-sm mt-1\">Create a new route by clicking points on the map</p>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full text-sm text-left text-gray-500\">\r\n                        <thead className=\"text-xs text-gray-700 uppercase bg-gray-50\">\r\n                            <tr>\r\n                                <th scope=\"col\" className=\"px-6 py-3\">Route ID</th>\r\n                                <th scope=\"col\" className=\"px-6 py-3\">Truck</th>\r\n                                <th scope=\"col\" className=\"px-6 py-3\">Municipal Council</th>\r\n                                <th scope=\"col\" className=\"px-6 py-3\">Distance</th>\r\n                                <th scope=\"col\" className=\"px-6 py-3\">Est. Time</th>\r\n                                <th scope=\"col\" className=\"px-6 py-3\">Status</th>\r\n                                <th scope=\"col\" className=\"px-6 py-3\">Actions</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {generatedRoutes.map((route) => (\r\n                              <tr key={route._id || route.id} className=\"bg-white border-b hover:bg-gray-50\">\r\n                                  <td \r\n                                    onClick={() => navigate(`/route-details/${route._id}`)} \r\n                                    className=\"px-6 py-4 font-medium text-emerald-600 hover:underline cursor-pointer\"\r\n                                  >\r\n                                    {route.routeId}\r\n                                  </td>\r\n                                  <td className=\"px-6 py-4\">{route.truck}</td>\r\n                                  <td className=\"px-6 py-4\">{route.municipalCouncil}</td>\r\n                                  <td className=\"px-6 py-4\">{route.distance}</td>\r\n                                  <td className=\"px-6 py-4\">\r\n                                    <span className=\"text-blue-600 font-medium\">\r\n                                      {route.estimatedTime || 'N/A'}\r\n                                    </span>\r\n                                  </td>\r\n                                  <td className=\"px-6 py-4\">\r\n                                    <span className=\"text-green-600 bg-green-100 px-2 py-1 rounded-full text-xs\">\r\n                                      {route.status}\r\n                                    </span>\r\n                                  </td>\r\n                                  <td className=\"px-6 py-4\">\r\n                                    <div className=\"flex gap-2\">\r\n                                      <button \r\n                                        onClick={() => handleDispatchRoute(route)}\r\n                                        className=\"font-medium text-emerald-600 hover:underline\"\r\n                                      >\r\n                                        Dispatch\r\n                                      </button>\r\n                                      <button \r\n                                        onClick={() => handleDeleteRoute(route._id)}\r\n                                        className=\"font-medium text-red-600 hover:underline\"\r\n                                      >\r\n                                        Delete\r\n                                      </button>\r\n                                    </div>\r\n                                  </td>\r\n                              </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                  </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,GAAG,IAAIC,4BAA4B,EAAEC,mBAAmB,QAAQ,mBAAmB;AAC1F,SAASC,QAAQ,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE3C,eAAe,SAASC,qBAAqBA,CAAA,EAAG;EAAAC,EAAA;EAC9C,MAAMC,QAAQ,GAAGX,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACY,YAAY,EAAEC,eAAe,CAAC,GAAGf,QAAQ,CAAC,2BAA2B,CAAC;EAC7E,MAAM,CAACgB,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGjB,QAAQ,CAAC,KAAK,CAAC;EACrE,MAAM,CAACkB,cAAc,EAAEC,iBAAiB,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EACxD,MAAM,CAACoB,eAAe,EAAEC,kBAAkB,CAAC,GAAGrB,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACsB,cAAc,EAAEC,iBAAiB,CAAC,GAAGvB,QAAQ,CAAC,IAAI,CAAC;EAC1D,MAAM,CAACwB,YAAY,EAAEC,eAAe,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAAC0B,gBAAgB,EAAEC,mBAAmB,CAAC,GAAG3B,QAAQ,CAAC,IAAI,CAAC;;EAE9D;EACAC,SAAS,CAAC,MAAM;IACd,MAAM2B,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAI;QACF,MAAMC,MAAM,GAAG,MAAMvB,QAAQ,CAACwB,YAAY,CAAC,CAAC;QAC5CC,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEH,MAAM,CAAC;QACtCR,kBAAkB,CAACQ,MAAM,CAAC;MAC5B,CAAC,CAAC,OAAOI,KAAK,EAAE;QAAA,IAAAC,eAAA,EAAAC,oBAAA;QACdJ,OAAO,CAACE,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;QAC/C,MAAMG,YAAY,GAAG,EAAAF,eAAA,GAAAD,KAAK,CAACI,QAAQ,cAAAH,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBI,IAAI,cAAAH,oBAAA,uBAApBA,oBAAA,CAAsBF,KAAK,KAAIA,KAAK,CAACM,OAAO,IAAI,eAAe;QACpFC,KAAK,CAAC,0BAA0BJ,YAAY,iEAAiE,CAAC;MAChH;IACF,CAAC;IACDR,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMa,gBAAgB,GAAGA,CAACC,KAAK,EAAEC,MAAM,GAAG,KAAK,KAAK;IAClD,IAAIA,MAAM,KAAK,QAAQ,EAAE;MACvBxB,iBAAiB,CAACyB,IAAI,IAAIA,IAAI,CAACC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKL,KAAK,CAACK,EAAE,CAAC,CAAC;IAChE,CAAC,MAAM;MACL5B,iBAAiB,CAACyB,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEF,KAAK,CAAC,CAAC;IAC7C;EACF,CAAC;;EAED;EACA,MAAMM,aAAa,GAAIC,MAAM,IAAK;IAChC,IAAIA,MAAM,CAACC,MAAM,GAAG,CAAC,EAAE,OAAOD,MAAM,CAACE,GAAG,CAACL,CAAC,IAAIA,CAAC,CAACM,QAAQ,CAAC;;IAEzD;IACA,MAAMC,cAAc,GAAGjD,4BAA4B,CAACkD,IAAI,CACtDZ,KAAK,IAAIA,KAAK,CAACa,gBAAgB,KAAKzC,YACtC,CAAC;IAED,IAAI,CAACuC,cAAc,EAAE;MACnB;MACA,MAAMG,SAAS,GAAG,CAAC,GAAGP,MAAM,CAAC;MAC7B,MAAMQ,KAAK,GAAG,EAAE;MAChB,IAAIC,OAAO,GAAGF,SAAS,CAACG,KAAK,CAAC,CAAC;MAC/BF,KAAK,CAACG,IAAI,CAACF,OAAO,CAACN,QAAQ,CAAC;MAE5B,OAAOI,SAAS,CAACN,MAAM,GAAG,CAAC,EAAE;QAC3B,IAAIW,OAAO,GAAGL,SAAS,CAAC,CAAC,CAAC;QAC1B,IAAIM,YAAY,GAAG,CAAC;QACpB,IAAIC,WAAW,GAAGC,WAAW,CAACN,OAAO,CAACN,QAAQ,EAAES,OAAO,CAACT,QAAQ,CAAC;QAEjE,KAAK,IAAIa,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,SAAS,CAACN,MAAM,EAAEe,CAAC,EAAE,EAAE;UACzC,MAAMC,QAAQ,GAAGF,WAAW,CAACN,OAAO,CAACN,QAAQ,EAAEI,SAAS,CAACS,CAAC,CAAC,CAACb,QAAQ,CAAC;UACrE,IAAIc,QAAQ,GAAGH,WAAW,EAAE;YAC1BA,WAAW,GAAGG,QAAQ;YACtBL,OAAO,GAAGL,SAAS,CAACS,CAAC,CAAC;YACtBH,YAAY,GAAGG,CAAC;UAClB;QACF;QAEAR,KAAK,CAACG,IAAI,CAACC,OAAO,CAACT,QAAQ,CAAC;QAC5BM,OAAO,GAAGG,OAAO;QACjBL,SAAS,CAACW,MAAM,CAACL,YAAY,EAAE,CAAC,CAAC;MACnC;MAEA,OAAOL,KAAK;IACd;;IAEA;IACA,MAAMW,aAAa,GAAG;MACpBrB,EAAE,EAAE,iBAAiB;MACrBK,QAAQ,EAAEC,cAAc,CAACD,QAAQ;MACjCiB,IAAI,EAAE,GAAGhB,cAAc,CAACgB,IAAI;IAC9B,CAAC;;IAED;IACA,MAAMb,SAAS,GAAG,CAAC,GAAGP,MAAM,CAAC;IAC7B,MAAMQ,KAAK,GAAG,CAACW,aAAa,CAAChB,QAAQ,CAAC,CAAC,CAAC;;IAExC;IACA,IAAII,SAAS,CAACN,MAAM,GAAG,CAAC,EAAE;MACxB,IAAIW,OAAO,GAAGL,SAAS,CAAC,CAAC,CAAC;MAC1B,IAAIM,YAAY,GAAG,CAAC;MACpB,IAAIC,WAAW,GAAGC,WAAW,CAACI,aAAa,CAAChB,QAAQ,EAAES,OAAO,CAACT,QAAQ,CAAC;MAEvE,KAAK,IAAIa,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,SAAS,CAACN,MAAM,EAAEe,CAAC,EAAE,EAAE;QACzC,MAAMC,QAAQ,GAAGF,WAAW,CAACI,aAAa,CAAChB,QAAQ,EAAEI,SAAS,CAACS,CAAC,CAAC,CAACb,QAAQ,CAAC;QAC3E,IAAIc,QAAQ,GAAGH,WAAW,EAAE;UAC1BA,WAAW,GAAGG,QAAQ;UACtBL,OAAO,GAAGL,SAAS,CAACS,CAAC,CAAC;UACtBH,YAAY,GAAGG,CAAC;QAClB;MACF;MAEA,IAAIP,OAAO,GAAGG,OAAO;MACrBJ,KAAK,CAACG,IAAI,CAACF,OAAO,CAACN,QAAQ,CAAC;MAC5BI,SAAS,CAACW,MAAM,CAACL,YAAY,EAAE,CAAC,CAAC;;MAEjC;MACA,OAAON,SAAS,CAACN,MAAM,GAAG,CAAC,EAAE;QAC3BW,OAAO,GAAGL,SAAS,CAAC,CAAC,CAAC;QACtBM,YAAY,GAAG,CAAC;QAChBC,WAAW,GAAGC,WAAW,CAACN,OAAO,CAACN,QAAQ,EAAES,OAAO,CAACT,QAAQ,CAAC;QAE7D,KAAK,IAAIa,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,SAAS,CAACN,MAAM,EAAEe,CAAC,EAAE,EAAE;UACzC,MAAMC,QAAQ,GAAGF,WAAW,CAACN,OAAO,CAACN,QAAQ,EAAEI,SAAS,CAACS,CAAC,CAAC,CAACb,QAAQ,CAAC;UACrE,IAAIc,QAAQ,GAAGH,WAAW,EAAE;YAC1BA,WAAW,GAAGG,QAAQ;YACtBL,OAAO,GAAGL,SAAS,CAACS,CAAC,CAAC;YACtBH,YAAY,GAAGG,CAAC;UAClB;QACF;QAEAR,KAAK,CAACG,IAAI,CAACC,OAAO,CAACT,QAAQ,CAAC;QAC5BM,OAAO,GAAGG,OAAO;QACjBL,SAAS,CAACW,MAAM,CAACL,YAAY,EAAE,CAAC,CAAC;MACnC;IACF;;IAEA;IACAL,KAAK,CAACG,IAAI,CAACQ,aAAa,CAAChB,QAAQ,CAAC;IAElC,OAAOK,KAAK;EACd,CAAC;;EAED;EACA,MAAMO,WAAW,GAAGA,CAACM,MAAM,EAAEC,MAAM,KAAK;IACtC,MAAMC,EAAE,GAAGF,MAAM,CAAC,CAAC,CAAC,GAAGC,MAAM,CAAC,CAAC,CAAC;IAChC,MAAME,EAAE,GAAGH,MAAM,CAAC,CAAC,CAAC,GAAGC,MAAM,CAAC,CAAC,CAAC;IAChC,OAAOG,IAAI,CAACC,IAAI,CAACH,EAAE,GAAGA,EAAE,GAAGC,EAAE,GAAGA,EAAE,CAAC;EACrC,CAAC;;EAED;EACA,MAAMG,0BAA0B,GAAIC,SAAS,IAAK;IAChD,IAAI,CAACA,SAAS,IAAIA,SAAS,CAAC3B,MAAM,GAAG,CAAC,EAAE,OAAO,CAAC;IAEhD,IAAI4B,aAAa,GAAG,CAAC;IACrB,KAAK,IAAIb,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGY,SAAS,CAAC3B,MAAM,GAAG,CAAC,EAAEe,CAAC,EAAE,EAAE;MAC7Ca,aAAa,IAAId,WAAW,CAACa,SAAS,CAACZ,CAAC,CAAC,EAAEY,SAAS,CAACZ,CAAC,GAAG,CAAC,CAAC,CAAC;IAC9D;IACA,OAAO,CAACa,aAAa,GAAG,MAAM,EAAEC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9C,CAAC;;EAED;EACA,MAAMC,sBAAsB,GAAIvB,KAAK,IAAK;IACxC,IAAIqB,aAAa,GAAG,CAAC;IACrB,KAAK,IAAIb,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGR,KAAK,CAACP,MAAM,GAAG,CAAC,EAAEe,CAAC,EAAE,EAAE;MACzCa,aAAa,IAAId,WAAW,CAACP,KAAK,CAACQ,CAAC,CAAC,EAAER,KAAK,CAACQ,CAAC,GAAG,CAAC,CAAC,CAAC;IACtD;IACA,OAAO,CAACa,aAAa,GAAG,MAAM,EAAEC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9C,CAAC;;EAED;EACA,MAAME,iBAAiB,GAAG,MAAOC,OAAO,IAAK;IAC3C,IAAIC,MAAM,CAACC,OAAO,CAAC,2EAA2E,CAAC,EAAE;MAC/F,IAAI;QACF,MAAM9E,QAAQ,CAAC+E,WAAW,CAACH,OAAO,CAAC;QACnC7D,kBAAkB,CAACuB,IAAI,IAAIA,IAAI,CAACC,MAAM,CAACY,KAAK,IAAIA,KAAK,CAACV,EAAE,KAAKmC,OAAO,CAAC,CAAC;QACtE1C,KAAK,CAAC,6BAA6B,CAAC;MACtC,CAAC,CAAC,OAAOP,KAAK,EAAE;QACdF,OAAO,CAACE,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;QAC/CO,KAAK,CAAC,2CAA2C,CAAC;MACpD;IACF;EACF,CAAC;;EAED;EACA,MAAM8C,mBAAmB,GAAG,MAAO7B,KAAK,IAAK;IAC3C,IAAI0B,MAAM,CAACC,OAAO,CAAC,2CAA2C3B,KAAK,CAACV,EAAE,aAAaU,KAAK,CAAC8B,KAAK,GAAG,CAAC,EAAE;MAClG,IAAI;QACF,MAAMC,YAAY,GAAG,MAAMlF,QAAQ,CAACmF,iBAAiB,CAAChC,KAAK,CAACV,EAAE,EAAE;UAC9D2C,MAAM,EAAE,YAAY;UACpBC,UAAU,EAAE;QACd,CAAC,CAAC;QACFtE,kBAAkB,CAACuB,IAAI,IACrBA,IAAI,CAACO,GAAG,CAACyC,CAAC,IAAKA,CAAC,CAAC7C,EAAE,KAAKU,KAAK,CAACV,EAAE,GAAGyC,YAAY,GAAGI,CAAE,CACtD,CAAC;QACDpD,KAAK,CAAC,SAASiB,KAAK,CAACV,EAAE,iCAAiCU,KAAK,CAAC8B,KAAK,GAAG,CAAC;MACzE,CAAC,CAAC,OAAOtD,KAAK,EAAE;QACdF,OAAO,CAACE,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjDO,KAAK,CAAC,6CAA6C,CAAC;MACtD;IACF;EACF,CAAC;;EAED;EACA,MAAMqD,wBAAwB,GAAIhB,SAAS,IAAK;IAC9ClD,mBAAmB,CAACkD,SAAS,CAAC;EAChC,CAAC;;EAED;EACA,MAAMiB,qBAAqB,GAAGA,CAAA,KAAM;IAClC,MAAMC,WAAW,GAAG3E,eAAe,CAAC+B,GAAG,CAACM,KAAK,IAAIA,KAAK,CAACyB,OAAO,IAAIzB,KAAK,CAACV,EAAE,CAAC;IAC3E,IAAIiD,KAAK;IACT,IAAIC,OAAO,GAAG,GAAG;;IAEjB;IACA,GAAG;MACDD,KAAK,GAAG,KAAKE,MAAM,CAACD,OAAO,CAAC,CAACE,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;MAC/CF,OAAO,EAAE;IACX,CAAC,QAAQF,WAAW,CAACK,QAAQ,CAACJ,KAAK,CAAC;IAEpC,OAAOA,KAAK;EACd,CAAC;;EAED;EACA,MAAMK,oBAAoB,GAAGA,CAAA,KAAM;IACjC,IAAInF,cAAc,CAACgC,MAAM,GAAG,CAAC,EAAE;MAC7BV,KAAK,CAAC,qDAAqD,CAAC;MAC5D;IACF;IAEAf,eAAe,CAAC,IAAI,CAAC;;IAErB;IACA,MAAM6E,cAAc,GAAGtD,aAAa,CAAC9B,cAAc,CAAC;IACpDK,iBAAiB,CAAC+E,cAAc,CAAC;;IAEjC;IACA;IACAC,UAAU,CAAC,YAAY;MACrB,MAAMC,aAAa,GAAG9E,gBAAgB,GACpCkD,0BAA0B,CAAClD,gBAAgB,CAAC,GAC5CkD,0BAA0B,CAAC0B,cAAc,CAAC;MAE5C,MAAMpB,OAAO,GAAGY,qBAAqB,CAAC,CAAC;MACvC,MAAMW,OAAO,GAAG,KAAKP,MAAM,CAACxB,IAAI,CAACgC,KAAK,CAAChC,IAAI,CAACiC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAACR,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;;MAElF;MACA,MAAMS,YAAY,GAAG;QACnB1B,OAAO,EAAEA,OAAO;QAChBK,KAAK,EAAEkB,OAAO;QACdlD,gBAAgB,EAAEzC,YAAY;QAC9BoD,QAAQ,EAAE,GAAGsC,aAAa,KAAK;QAC/Bd,MAAM,EAAE,WAAW;QACnBzC,MAAM,EAAE/B,cAAc,CAACiC,GAAG,CAACL,CAAC,KAAK;UAAE+D,GAAG,EAAE/D,CAAC,CAACM,QAAQ,CAAC,CAAC,CAAC;UAAE0D,GAAG,EAAEhE,CAAC,CAACM,QAAQ,CAAC,CAAC,CAAC;UAAEL,EAAE,EAAED,CAAC,CAACC;QAAG,CAAC,CAAC,CAAC;QACvFU,KAAK,EAAE6C,cAAc,CAACnD,GAAG,CAACL,CAAC,KAAK;UAAE+D,GAAG,EAAE/D,CAAC,CAAC,CAAC,CAAC;UAAEgE,GAAG,EAAEhE,CAAC,CAAC,CAAC;QAAE,CAAC,CAAC,CAAC;QAC1D+B,SAAS,EAAEnD,gBAAgB,GAAGA,gBAAgB,CAACyB,GAAG,CAACL,CAAC,KAAK;UAAE+D,GAAG,EAAE/D,CAAC,CAAC,CAAC,CAAC;UAAEgE,GAAG,EAAEhE,CAAC,CAAC,CAAC;QAAE,CAAC,CAAC,CAAC,GAAG,EAAE;QACxF6C,UAAU,EAAE;MACd,CAAC;MAED,IAAI;QACF5D,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAE4E,YAAY,CAAC;QACpD,MAAMG,UAAU,GAAG,MAAMzG,QAAQ,CAAC0G,WAAW,CAACJ,YAAY,CAAC;QAC3D7E,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAE+E,UAAU,CAAC;;QAEpD;QACA,MAAME,SAAS,GAAG,MAAM3G,QAAQ,CAACwB,YAAY,CAAC,CAAC;QAC/CT,kBAAkB,CAAC4F,SAAS,CAAC;QAE7BzE,KAAK,CAAC,uDAAuD,GAAG0C,OAAO,GAAG,WAAW,GAAGuB,OAAO,CAAC;MAClG,CAAC,CAAC,OAAOxE,KAAK,EAAE;QAAA,IAAAiF,gBAAA,EAAAC,gBAAA;QACdpF,OAAO,CAACE,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;;QAE7C;QACA,IAAI,EAAAiF,gBAAA,GAAAjF,KAAK,CAACI,QAAQ,cAAA6E,gBAAA,uBAAdA,gBAAA,CAAgBxB,MAAM,MAAK,GAAG,EAAE;UAAA,IAAA0B,gBAAA,EAAAC,qBAAA;UAClC,MAAMjF,YAAY,GAAG,EAAAgF,gBAAA,GAAAnF,KAAK,CAACI,QAAQ,cAAA+E,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgB9E,IAAI,cAAA+E,qBAAA,uBAApBA,qBAAA,CAAsB9E,OAAO,KAAI,+BAA+B;UACrFC,KAAK,CAAC,2BAA2BJ,YAAY,qFAAqF,CAAC;QACrI,CAAC,MAAM,IAAI,EAAA+E,gBAAA,GAAAlF,KAAK,CAACI,QAAQ,cAAA8E,gBAAA,uBAAdA,gBAAA,CAAgBzB,MAAM,MAAK,GAAG,EAAE;UAAA,IAAA4B,gBAAA,EAAAC,qBAAA;UACzC,MAAMnF,YAAY,GAAG,EAAAkF,gBAAA,GAAArF,KAAK,CAACI,QAAQ,cAAAiF,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBhF,IAAI,cAAAiF,qBAAA,uBAApBA,qBAAA,CAAsBtF,KAAK,KAAI,oBAAoB;UACxEO,KAAK,CAAC,qBAAqBJ,YAAY,iDAAiD,CAAC;QAC3F,CAAC,MAAM,IAAI,CAACH,KAAK,CAACI,QAAQ,EAAE;UAC1BG,KAAK,CAAC,iMAAiM,CAAC;QAC1M,CAAC,MAAM;UAAA,IAAAgF,gBAAA,EAAAC,qBAAA;UACL,MAAMrF,YAAY,GAAG,EAAAoF,gBAAA,GAAAvF,KAAK,CAACI,QAAQ,cAAAmF,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBlF,IAAI,cAAAmF,qBAAA,uBAApBA,qBAAA,CAAsBxF,KAAK,KAAIA,KAAK,CAACM,OAAO,IAAI,eAAe;UACpFC,KAAK,CAAC,6BAA6BJ,YAAY,uBAAuB,CAAC;QACzE;MACF,CAAC,SAAS;QACRX,eAAe,CAAC,KAAK,CAAC;MACxB;IACF,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;EACZ,CAAC;;EAED;EACA,MAAMiG,gBAAgB,GAAGA,CAAA,KAAM;IAC7BvG,iBAAiB,CAAC,EAAE,CAAC;IACrBI,iBAAiB,CAAC,IAAI,CAAC;IACvBI,mBAAmB,CAAC,IAAI,CAAC;IACzBV,sBAAsB,CAAC,KAAK,CAAC;EAC/B,CAAC;;EAED;EACA,MAAM0G,uBAAuB,GAAGA,CAAA,KAAM;IACpC;IACAxG,iBAAiB,CAAC,EAAE,CAAC;IACrBI,iBAAiB,CAAC,IAAI,CAAC;IACvBI,mBAAmB,CAAC,IAAI,CAAC;IAEzBF,eAAe,CAAC,IAAI,CAAC;IACrBR,sBAAsB,CAAC,KAAK,CAAC,CAAC,CAAC;;IAE/B;IACA,MAAM2G,WAAW,GAAGvH,mBAAmB,CAACwC,MAAM,CAC5CgF,GAAG,IAAIA,GAAG,CAACtE,gBAAgB,KAAKzC,YAClC,CAAC;IAED,IAAI8G,WAAW,CAAC1E,MAAM,KAAK,CAAC,EAAE;MAC5BV,KAAK,CAAC,yDAAyD,CAAC;MAChEf,eAAe,CAAC,KAAK,CAAC;MACtB;IACF;;IAEA;IACA,MAAM4B,cAAc,GAAGjD,4BAA4B,CAACkD,IAAI,CACtDZ,KAAK,IAAIA,KAAK,CAACa,gBAAgB,KAAKzC,YACtC,CAAC;IAED,IAAI,CAACuC,cAAc,EAAE;MACnBb,KAAK,CAAC,oCAAoC,CAAC;MAC3Cf,eAAe,CAAC,KAAK,CAAC;MACtB;IACF;;IAEA;IACA,MAAMqG,gBAAgB,GAAGF,WAAW,CAACzE,GAAG,CAAC0E,GAAG,KAAK;MAC/C,GAAGA,GAAG;MACNE,iBAAiB,EAAE/D,WAAW,CAACX,cAAc,CAACD,QAAQ,EAAEyE,GAAG,CAACzE,QAAQ;IACtE,CAAC,CAAC,CAAC;;IAEH;IACA,MAAM4E,eAAe,GAAGtD,IAAI,CAACuD,GAAG,CAAC,EAAE,EAAEH,gBAAgB,CAAC5E,MAAM,CAAC;IAC7D,MAAMgF,YAAY,GAAGJ,gBAAgB,CAClCK,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACL,iBAAiB,GAAGM,CAAC,CAACN,iBAAiB,CAAC,CACzDO,KAAK,CAAC,CAAC,EAAEN,eAAe,CAAC;;IAE5B;IACA,MAAMO,kBAAkB,GAAGL,YAAY,CAAC/E,GAAG,CAAC,CAAC0E,GAAG,EAAEW,KAAK,MAAM;MAC3DzF,EAAE,EAAE8E,GAAG,CAAC9E,EAAE;MACVK,QAAQ,EAAEyE,GAAG,CAACzE,QAAQ;MACtBiB,IAAI,EAAE,oBAAoBmE,KAAK,GAAG,CAAC,EAAE;MACrC9C,MAAM,EAAE;IACV,CAAC,CAAC,CAAC;;IAEH;IACAvE,iBAAiB,CAACoH,kBAAkB,CAAC;;IAErC;IACAhC,UAAU,CAAC,YAAY;MACrB,MAAMD,cAAc,GAAGtD,aAAa,CAACuF,kBAAkB,CAAC;MACxDhH,iBAAiB,CAAC+E,cAAc,CAAC;;MAEjC;MACAC,UAAU,CAAC,YAAY;QACrB,MAAMC,aAAa,GAAG9E,gBAAgB,GACpCkD,0BAA0B,CAAClD,gBAAgB,CAAC,GAC5CkD,0BAA0B,CAAC0B,cAAc,CAAC;QAE5C,MAAMpB,OAAO,GAAGY,qBAAqB,CAAC,CAAC;QACvC,MAAMW,OAAO,GAAG,KAAKP,MAAM,CAACxB,IAAI,CAACgC,KAAK,CAAChC,IAAI,CAACiC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAACR,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;;QAElF;QACA,MAAMS,YAAY,GAAG;UACnB1B,OAAO,EAAEA,OAAO;UAChBK,KAAK,EAAEkB,OAAO;UACdlD,gBAAgB,EAAEzC,YAAY;UAC9BoD,QAAQ,EAAE,GAAGsC,aAAa,KAAK;UAC/Bd,MAAM,EAAE,WAAW;UACnBzC,MAAM,EAAEsF,kBAAkB,CAACpF,GAAG,CAACL,CAAC,KAAK;YAAE+D,GAAG,EAAE/D,CAAC,CAACM,QAAQ,CAAC,CAAC,CAAC;YAAE0D,GAAG,EAAEhE,CAAC,CAACM,QAAQ,CAAC,CAAC,CAAC;YAAEL,EAAE,EAAED,CAAC,CAACC;UAAG,CAAC,CAAC,CAAC;UAC3FU,KAAK,EAAE6C,cAAc,CAACnD,GAAG,CAACL,CAAC,KAAK;YAAE+D,GAAG,EAAE/D,CAAC,CAAC,CAAC,CAAC;YAAEgE,GAAG,EAAEhE,CAAC,CAAC,CAAC;UAAE,CAAC,CAAC,CAAC;UAC1D+B,SAAS,EAAEnD,gBAAgB,GAAGA,gBAAgB,CAACyB,GAAG,CAACL,CAAC,KAAK;YAAE+D,GAAG,EAAE/D,CAAC,CAAC,CAAC,CAAC;YAAEgE,GAAG,EAAEhE,CAAC,CAAC,CAAC;UAAE,CAAC,CAAC,CAAC,GAAG,EAAE;UACxF6C,UAAU,EAAE;QACd,CAAC;QAED,IAAI;UACF5D,OAAO,CAACC,GAAG,CAAC,wCAAwC,EAAE4E,YAAY,CAAC;UACnE,MAAMG,UAAU,GAAG,MAAMzG,QAAQ,CAAC0G,WAAW,CAACJ,YAAY,CAAC;UAC3D7E,OAAO,CAACC,GAAG,CAAC,0CAA0C,EAAE+E,UAAU,CAAC;;UAEnE;UACA,MAAME,SAAS,GAAG,MAAM3G,QAAQ,CAACwB,YAAY,CAAC,CAAC;UAC/CT,kBAAkB,CAAC4F,SAAS,CAAC;UAE7BzE,KAAK,CAAC,kDAAkDwF,eAAe,oCAAoC9C,OAAO,YAAYuB,OAAO,eAAeD,aAAa,KAAK,CAAC;;UAEvK;UACArF,iBAAiB,CAAC,EAAE,CAAC;UACrBI,iBAAiB,CAAC,IAAI,CAAC;UACvBI,mBAAmB,CAAC,IAAI,CAAC;QAC3B,CAAC,CAAC,OAAOM,KAAK,EAAE;UAAA,IAAAwG,gBAAA,EAAAC,gBAAA;UACd3G,OAAO,CAACE,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;;UAE5D;UACA,IAAI,EAAAwG,gBAAA,GAAAxG,KAAK,CAACI,QAAQ,cAAAoG,gBAAA,uBAAdA,gBAAA,CAAgB/C,MAAM,MAAK,GAAG,EAAE;YAAA,IAAAiD,gBAAA,EAAAC,qBAAA;YAClC,MAAMxG,YAAY,GAAG,EAAAuG,gBAAA,GAAA1G,KAAK,CAACI,QAAQ,cAAAsG,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBrG,IAAI,cAAAsG,qBAAA,uBAApBA,qBAAA,CAAsBrG,OAAO,KAAI,+BAA+B;YACrFC,KAAK,CAAC,2BAA2BJ,YAAY,qFAAqF,CAAC;UACrI,CAAC,MAAM,IAAI,EAAAsG,gBAAA,GAAAzG,KAAK,CAACI,QAAQ,cAAAqG,gBAAA,uBAAdA,gBAAA,CAAgBhD,MAAM,MAAK,GAAG,EAAE;YAAA,IAAAmD,gBAAA,EAAAC,qBAAA;YACzC,MAAM1G,YAAY,GAAG,EAAAyG,gBAAA,GAAA5G,KAAK,CAACI,QAAQ,cAAAwG,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBvG,IAAI,cAAAwG,qBAAA,uBAApBA,qBAAA,CAAsB7G,KAAK,KAAI,oBAAoB;YACxEO,KAAK,CAAC,qBAAqBJ,YAAY,sDAAsD,CAAC;UAChG,CAAC,MAAM,IAAI,CAACH,KAAK,CAACI,QAAQ,EAAE;YAC1BG,KAAK,CAAC,8GAA8G,CAAC;UACvH,CAAC,MAAM;YAAA,IAAAuG,gBAAA,EAAAC,qBAAA;YACL,MAAM5G,YAAY,GAAG,EAAA2G,gBAAA,GAAA9G,KAAK,CAACI,QAAQ,cAAA0G,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBzG,IAAI,cAAA0G,qBAAA,uBAApBA,qBAAA,CAAsB/G,KAAK,KAAIA,KAAK,CAACM,OAAO,IAAI,eAAe;YACpFC,KAAK,CAAC,6BAA6BJ,YAAY,uBAAuB,CAAC;UACzE;QACF,CAAC,SAAS;UACRX,eAAe,CAAC,KAAK,CAAC;QACxB;MACF,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;IACZ,CAAC,EAAE,GAAG,CAAC;EACT,CAAC;;EAED;EACA,MAAMwH,uBAAuB,GAAGA,CAAA,KAAM;IACpChI,sBAAsB,CAAC2B,IAAI,IAAI,CAACA,IAAI,CAAC;IACrC,IAAI5B,mBAAmB,EAAE;MACvB0G,gBAAgB,CAAC,CAAC;IACpB;EACF,CAAC;EACD,MAAMwB,oBAAoB,GAAG,MAAAA,CAAA,KAAY;IACvC,IAAI;MACF,MAAMC,WAAW,GAAG,MAAM7I,QAAQ,CAAC8I,cAAc,CAAC,CAAC;MACnD,IAAID,WAAW,IAAIA,WAAW,CAACE,GAAG,EAAE;QAClCxI,QAAQ,CAAC,kBAAkBsI,WAAW,CAACE,GAAG,EAAE,CAAC;MAC/C,CAAC,MAAM;QACL7G,KAAK,CAAC,0CAA0C,CAAC;MACnD;IACF,CAAC,CAAC,OAAOP,KAAK,EAAE;MACdO,KAAK,CAAC,mCAAmC,CAAC;IAC5C;EACF,CAAC;EAED,oBACEhC,OAAA;IAAK8I,SAAS,EAAC,4CAA4C;IAAAC,QAAA,gBAEzD/I,OAAA;MAAO8I,SAAS,EAAC,uCAAuC;MAAAC,QAAA,gBACtD/I,OAAA;QAAKgJ,OAAO,EAAEA,CAAA,KAAM3I,QAAQ,CAAC,GAAG,CAAE;QAACyI,SAAS,EAAC,qDAAqD;QAAAC,QAAA,gBAChG/I,OAAA;UAAK8I,SAAS,EAAC,iHAAiH;UAAAC,QAAA,eAC9H/I,OAAA;YAAKiJ,KAAK,EAAC,IAAI;YAACC,MAAM,EAAC,IAAI;YAACC,OAAO,EAAC,WAAW;YAACC,IAAI,EAAC,MAAM;YAACC,KAAK,EAAC,4BAA4B;YAAAN,QAAA,eAC5F/I,OAAA;cAAMsJ,CAAC,EAAC,yBAAyB;cAACC,MAAM,EAAC,OAAO;cAACC,WAAW,EAAC,KAAK;cAACC,aAAa,EAAC,OAAO;cAACC,cAAc,EAAC;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAC;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC9G;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eACN9J,OAAA;UAAA+I,QAAA,gBACE/I,OAAA;YAAK8I,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAU;YAAAY,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACvD9J,OAAA;YAAK8I,SAAS,EAAC,+BAA+B;YAAAC,QAAA,EAAC;UAAkB;YAAAY,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eACN9J,OAAA;QAAK8I,SAAS,EAAC,sBAAsB;QAAAC,QAAA,gBACnC/I,OAAA;UAAG+J,IAAI,EAAC,GAAG;UAACf,OAAO,EAAEA,CAAA,KAAM3I,QAAQ,CAAC,YAAY,CAAE;UAACyI,SAAS,EAAC,gEAAgE;UAAAC,QAAA,EAAC;QAAS;UAAAY,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eAC3I9J,OAAA;UAAG+J,IAAI,EAAC,GAAG;UAACf,OAAO,EAAEA,CAAA,KAAM3I,QAAQ,CAAC,SAAS,CAAE;UAACyI,SAAS,EAAC,2FAA2F;UAAAC,QAAA,EAAC;QAAM;UAAAY,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eAChK9J,OAAA;UAAG+J,IAAI,EAAC,GAAG;UAACf,OAAO,EAAEN,oBAAqB;UAACI,SAAS,EAAC,gEAAgE;UAAAC,QAAA,EAAC;QAAa;UAAAY,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpI,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CAAC,eAGR9J,OAAA;MAAK8I,SAAS,EAAC,sBAAsB;MAAAC,QAAA,gBACnC/I,OAAA;QAAQ8I,SAAS,EAAC,wBAAwB;QAAAC,QAAA,eACxC/I,OAAA;UAAI8I,SAAS,EAAC,uBAAuB;UAAAC,QAAA,EAAC;QAA0B;UAAAY,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC/D,CAAC,eAET9J,OAAA;QAAM8I,SAAS,EAAC,4CAA4C;QAAAC,QAAA,gBAE1D/I,OAAA;UAAK8I,SAAS,EAAC,0EAA0E;UAAAC,QAAA,gBACvF/I,OAAA;YAAI8I,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAa;YAAAY,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACxD9J,OAAA;YAAK8I,SAAS,EAAC,gBAAgB;YAAAC,QAAA,gBAC7B/I,OAAA;cAAA+I,QAAA,gBACE/I,OAAA;gBAAOgK,OAAO,EAAC,MAAM;gBAAClB,SAAS,EAAC,yCAAyC;gBAAAC,QAAA,EAAC;cAAwB;gBAAAY,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eAC1G9J,OAAA;gBACEuC,EAAE,EAAC,MAAM;gBACT0H,KAAK,EAAE3J,YAAa;gBACpB4J,QAAQ,EAAGC,CAAC,IAAK5J,eAAe,CAAC4J,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;gBACjDnB,SAAS,EAAC,sJAAsJ;gBAAAC,QAAA,gBAEhK/I,OAAA;kBAAA+I,QAAA,EAAQ;gBAAyB;kBAAAY,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,eAC1C9J,OAAA;kBAAA+I,QAAA,EAAQ;gBAAwC;kBAAAY,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,eACzD9J,OAAA;kBAAA+I,QAAA,EAAQ;gBAA2C;kBAAAY,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,eAC5D9J,OAAA;kBAAA+I,QAAA,EAAQ;gBAA0B;kBAAAY,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACrC,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CAAC,eAEN9J,OAAA;cAAK8I,SAAS,EAAC,WAAW;cAAAC,QAAA,gBACxB/I,OAAA;gBACEgJ,OAAO,EAAEP,uBAAwB;gBACjCK,SAAS,EAAE,+DACTtI,mBAAmB,GACf,wCAAwC,GACxC,gDAAgD,EACnD;gBAAAuI,QAAA,EAEFvI,mBAAmB,GAAG,uBAAuB,GAAG;cAAkB;gBAAAmJ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7D,CAAC,eAET9J,OAAA;gBACEgJ,OAAO,EAAE7B,uBAAwB;gBACjCkD,QAAQ,EAAErJ,YAAa;gBACvB8H,SAAS,EAAE,4GACT9H,YAAY,GACR,8CAA8C,GAC9C,qKAAqK,EACxK;gBAAA+H,QAAA,gBAEH/I,OAAA;kBAAM8I,SAAS,EAAC,wCAAwC;kBAAAC,QAAA,EACrD/H,YAAY,gBACXhB,OAAA,CAAAE,SAAA;oBAAA6I,QAAA,gBACE/I,OAAA;sBAAK8I,SAAS,EAAC,sBAAsB;sBAACO,KAAK,EAAC,4BAA4B;sBAACD,IAAI,EAAC,MAAM;sBAACD,OAAO,EAAC,WAAW;sBAAAJ,QAAA,gBACtG/I,OAAA;wBAAQ8I,SAAS,EAAC,YAAY;wBAACwB,EAAE,EAAC,IAAI;wBAACC,EAAE,EAAC,IAAI;wBAACnF,CAAC,EAAC,IAAI;wBAACmE,MAAM,EAAC,cAAc;wBAACC,WAAW,EAAC;sBAAG;wBAAAG,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAS,CAAC,eACrG9J,OAAA;wBAAM8I,SAAS,EAAC,YAAY;wBAACM,IAAI,EAAC,cAAc;wBAACE,CAAC,EAAC;sBAAiH;wBAAAK,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACzK,CAAC,eACN9J,OAAA;sBAAA+I,QAAA,EAAM;oBAAsB;sBAAAY,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM,CAAC;kBAAA,eACnC,CAAC,gBAEH9J,OAAA,CAAAE,SAAA;oBAAA6I,QAAA,gBACE/I,OAAA;sBAAK8I,SAAS,EAAC,SAAS;sBAACM,IAAI,EAAC,MAAM;sBAACG,MAAM,EAAC,cAAc;sBAACJ,OAAO,EAAC,WAAW;sBAACE,KAAK,EAAC,4BAA4B;sBAAAN,QAAA,eAC/G/I,OAAA;wBAAMyJ,aAAa,EAAC,OAAO;wBAACC,cAAc,EAAC,OAAO;wBAACF,WAAW,EAAC,GAAG;wBAACF,CAAC,EAAC;sBAAkN;wBAAAK,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO;oBAAC;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAC5R,CAAC,eACN9J,OAAA;sBAAA+I,QAAA,EAAM;oBAAsB;sBAAAY,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM,CAAC,eACnC9J,OAAA;sBAAK8I,SAAS,EAAC,oBAAoB;sBAACM,IAAI,EAAC,cAAc;sBAACD,OAAO,EAAC,WAAW;sBAACE,KAAK,EAAC,4BAA4B;sBAAAN,QAAA,eAC5G/I,OAAA;wBAAMwK,QAAQ,EAAC,SAAS;wBAAClB,CAAC,EAAC,0IAA0I;wBAACmB,QAAQ,EAAC;sBAAS;wBAAAd,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO;oBAAC;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAC7L,CAAC;kBAAA,eACN;gBACH;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACG,CAAC,EACN,CAAC9I,YAAY,iBACZhB,OAAA;kBAAM8I,SAAS,EAAC,iGAAiG;kBAAAC,QAAA,eAC/G/I,OAAA;oBAAM8I,SAAS,EAAC;kBAAsC;oBAAAa,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC1D,CACP;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACK,CAAC,EAERtJ,mBAAmB,iBAClBR,OAAA,CAAAE,SAAA;gBAAA6I,QAAA,gBACE/I,OAAA;kBAAK8I,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,gBAC9D/I,OAAA;oBAAG8I,SAAS,EAAC,aAAa;oBAAAC,QAAA,GAAC,mBAAiB,EAACrI,cAAc,CAACgC,MAAM;kBAAA;oBAAAiH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACvE9J,OAAA;oBAAG8I,SAAS,EAAC,cAAc;oBAAAC,QAAA,EAAC;kBAAyC;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAG,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACtE,CAAC,eAEN9J,OAAA;kBACEgJ,OAAO,EAAEnD,oBAAqB;kBAC9BwE,QAAQ,EAAE3J,cAAc,CAACgC,MAAM,GAAG,CAAC,IAAI1B,YAAa;kBACpD8H,SAAS,EAAE,+DACTpI,cAAc,CAACgC,MAAM,GAAG,CAAC,IAAI1B,YAAY,GACrC,8CAA8C,GAC9C,gDAAgD,EACnD;kBAAA+H,QAAA,EAEF/H,YAAY,GAAG,eAAe,GAAG;gBAAgB;kBAAA2I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC5C,CAAC,EAERpJ,cAAc,CAACgC,MAAM,GAAG,CAAC,iBACxB1C,OAAA;kBACEgJ,OAAO,EAAE9B,gBAAiB;kBAC1B4B,SAAS,EAAC,sGAAsG;kBAAAC,QAAA,EACjH;gBAED;kBAAAY,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CACT;cAAA,eACD,CACH;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAGN9J,OAAA;UAAK8I,SAAS,EAAC,0EAA0E;UAAAC,QAAA,eACvF/I,OAAA;YAAK8I,SAAS,EAAC,MAAM;YAAAC,QAAA,eACnB/I,OAAA,CAACL,GAAG;cACFW,YAAY,EAAEA,YAAa;cAC3BE,mBAAmB,EAAEA,mBAAoB;cACzCE,cAAc,EAAEA,cAAe;cAC/BgK,YAAY,EAAEzI,gBAAiB;cAC/BnB,cAAc,EAAEA,cAAe;cAC/B6J,iBAAiB,EAAE,CAACnK,mBAAoB;cACxCoK,gBAAgB,EAAEvF;YAAyB;cAAAsE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC5C;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC,eAGP9J,OAAA;QAAK8I,SAAS,EAAC,KAAK;QAAAC,QAAA,eAChB/I,OAAA;UAAK8I,SAAS,EAAC,0DAA0D;UAAAC,QAAA,gBACrE/I,OAAA;YAAK8I,SAAS,EAAC,wCAAwC;YAAAC,QAAA,gBACrD/I,OAAA;cAAI8I,SAAS,EAAC,uBAAuB;cAAAC,QAAA,EAAC;YAAgB;cAAAY,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,EAC1DlJ,eAAe,CAAC8B,MAAM,GAAG,CAAC,iBACzB1C,OAAA;cAAM8I,SAAS,EAAC,uBAAuB;cAAAC,QAAA,GAAC,gBACxB,EAACnI,eAAe,CAAC8B,MAAM;YAAA;cAAAiH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjC,CACP;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,EAELlJ,eAAe,CAAC8B,MAAM,KAAK,CAAC,gBAC3B1C,OAAA;YAAK8I,SAAS,EAAC,gCAAgC;YAAAC,QAAA,gBAC7C/I,OAAA;cAAG8I,SAAS,EAAC,SAAS;cAAAC,QAAA,EAAC;YAAuB;cAAAY,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eAClD9J,OAAA;cAAG8I,SAAS,EAAC,cAAc;cAAAC,QAAA,EAAC;YAAgD;cAAAY,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7E,CAAC,gBAEN9J,OAAA;YAAK8I,SAAS,EAAC,iBAAiB;YAAAC,QAAA,eAC9B/I,OAAA;cAAO8I,SAAS,EAAC,wCAAwC;cAAAC,QAAA,gBACrD/I,OAAA;gBAAO8I,SAAS,EAAC,4CAA4C;gBAAAC,QAAA,eACzD/I,OAAA;kBAAA+I,QAAA,gBACI/I,OAAA;oBAAI6K,KAAK,EAAC,KAAK;oBAAC/B,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAQ;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnD9J,OAAA;oBAAI6K,KAAK,EAAC,KAAK;oBAAC/B,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAK;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eAChD9J,OAAA;oBAAI6K,KAAK,EAAC,KAAK;oBAAC/B,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAiB;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eAC5D9J,OAAA;oBAAI6K,KAAK,EAAC,KAAK;oBAAC/B,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAQ;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnD9J,OAAA;oBAAI6K,KAAK,EAAC,KAAK;oBAAC/B,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAS;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACpD9J,OAAA;oBAAI6K,KAAK,EAAC,KAAK;oBAAC/B,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAM;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACjD9J,OAAA;oBAAI6K,KAAK,EAAC,KAAK;oBAAC/B,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAO;oBAAAY,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAClD;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACF,CAAC,eACR9J,OAAA;gBAAA+I,QAAA,EACKnI,eAAe,CAAC+B,GAAG,CAAEM,KAAK,iBACzBjD,OAAA;kBAAgC8I,SAAS,EAAC,oCAAoC;kBAAAC,QAAA,gBAC1E/I,OAAA;oBACEgJ,OAAO,EAAEA,CAAA,KAAM3I,QAAQ,CAAC,kBAAkB4C,KAAK,CAAC4F,GAAG,EAAE,CAAE;oBACvDC,SAAS,EAAC,uEAAuE;oBAAAC,QAAA,EAEhF9F,KAAK,CAACyB;kBAAO;oBAAAiF,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACZ,CAAC,eACL9J,OAAA;oBAAI8I,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAE9F,KAAK,CAAC8B;kBAAK;oBAAA4E,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAC5C9J,OAAA;oBAAI8I,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAE9F,KAAK,CAACF;kBAAgB;oBAAA4G,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eACvD9J,OAAA;oBAAI8I,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAE9F,KAAK,CAACS;kBAAQ;oBAAAiG,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAC/C9J,OAAA;oBAAI8I,SAAS,EAAC,WAAW;oBAAAC,QAAA,eACvB/I,OAAA;sBAAM8I,SAAS,EAAC,2BAA2B;sBAAAC,QAAA,EACxC9F,KAAK,CAAC6H,aAAa,IAAI;oBAAK;sBAAAnB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACzB;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACL,CAAC,eACL9J,OAAA;oBAAI8I,SAAS,EAAC,WAAW;oBAAAC,QAAA,eACvB/I,OAAA;sBAAM8I,SAAS,EAAC,4DAA4D;sBAAAC,QAAA,EACzE9F,KAAK,CAACiC;oBAAM;sBAAAyE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACT;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACL,CAAC,eACL9J,OAAA;oBAAI8I,SAAS,EAAC,WAAW;oBAAAC,QAAA,eACvB/I,OAAA;sBAAK8I,SAAS,EAAC,YAAY;sBAAAC,QAAA,gBACzB/I,OAAA;wBACEgJ,OAAO,EAAEA,CAAA,KAAMlE,mBAAmB,CAAC7B,KAAK,CAAE;wBAC1C6F,SAAS,EAAC,8CAA8C;wBAAAC,QAAA,EACzD;sBAED;wBAAAY,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAQ,CAAC,eACT9J,OAAA;wBACEgJ,OAAO,EAAEA,CAAA,KAAMvE,iBAAiB,CAACxB,KAAK,CAAC4F,GAAG,CAAE;wBAC5CC,SAAS,EAAC,0CAA0C;wBAAAC,QAAA,EACrD;sBAED;wBAAAY,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAQ,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACN;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACJ,CAAC;gBAAA,GAnCA7G,KAAK,CAAC4F,GAAG,IAAI5F,KAAK,CAACV,EAAE;kBAAAoH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAoC1B,CACL;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACL;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC1J,EAAA,CA5oBuBD,qBAAqB;EAAA,QAC1BT,WAAW;AAAA;AAAAqL,EAAA,GADN5K,qBAAqB;AAAA,IAAA4K,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}